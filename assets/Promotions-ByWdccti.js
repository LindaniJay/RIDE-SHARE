import{r as e,j as t}from"./react-vendor-DFf_48ct.js";import{I as s}from"./admin-pages-DaMQ-yF4.js";import"./vendor-eiHq4GmM.js";import"./firebase-B6ibEfTD.js";import"./utils-Bi8vyz5k.js";const i=({userId:i,className:a=""})=>{const[n,o]=e.useState([]),[c,l]=e.useState(!0),[r,d]=e.useState("");e.useEffect(()=>{m()},[i]);const m=async()=>{try{const e=localStorage.getItem("authToken"),t=await fetch(`/api/users/${i}/promotions`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(t.ok){const e=await t.json();o(e.promotions||[])}}catch(e){o([{id:"1",code:"WELCOME20",title:"Welcome Bonus",description:"20% off your first booking",discountType:"percentage",discountValue:20,minBookingAmount:500,validUntil:new Date(Date.now()+2592e6),isActive:!0,usageCount:0,maxUsage:1},{id:"2",code:"SAVE100",title:"Fixed Discount",description:"R100 off bookings over R1000",discountType:"fixed",discountValue:100,minBookingAmount:1e3,validUntil:new Date(Date.now()+12096e5),isActive:!0,usageCount:0,maxUsage:3}])}finally{l(!1)}},x=e=>"percentage"===e.discountType?`${e.discountValue}% off`:`R${e.discountValue} off`,p=e=>new Date>e;return c?t.jsx("div",{className:`space-y-3 ${a}`,children:[...Array(2)].map((e,s)=>t.jsx("div",{className:"animate-pulse",children:t.jsx("div",{className:"h-20 bg-white/10 rounded-lg"})},s))}):t.jsx("div",{className:`space-y-4 ${a}`,children:0===n.length?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(s,{name:"Gift",size:"lg",className:"text-white/50 mb-2"}),t.jsx("p",{className:"text-white/70 text-sm",children:"No promotions available"})]}):n.map(e=>t.jsxs("div",{className:"p-4 rounded-lg border "+(p(e.validUntil)?"bg-gray-500/20 border-gray-500/30":"bg-green-500/20 border-green-500/30"),children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(s,{name:"Gift",size:"sm"}),t.jsx("span",{className:"font-semibold text-white",children:e.title}),t.jsxs("span",{className:"text-xs text-white/70",children:["(",e.code,")"]})]}),t.jsx("span",{className:"text-sm font-bold "+(p(e.validUntil)?"text-gray-400":"text-green-400"),children:x(e)})]}),t.jsx("p",{className:"text-sm text-white/80 mb-3",children:e.description}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"text-xs text-white/60",children:["Valid until: ",e.validUntil.toLocaleDateString(),e.minBookingAmount&&t.jsxs("span",{className:"ml-2",children:["â€¢ Min: R",e.minBookingAmount]})]}),!p(e.validUntil)&&t.jsx("button",{onClick:()=>(async e=>{try{const t=localStorage.getItem("authToken");(await fetch(`/api/users/${i}/promotions/apply`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({code:e})})).ok&&d(e)}catch(t){}})(e.code),className:"px-3 py-1 rounded-lg text-xs font-medium transition-colors "+(r===e.code?"bg-blue-500/20 text-blue-300":"bg-white/10 text-white hover:bg-white/20"),children:r===e.code?"Applied":"Use Code"})]})]},e.id))})};export{i as Promotions,i as default};
