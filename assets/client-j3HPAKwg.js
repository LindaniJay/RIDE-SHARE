const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CWJzhqZF.js","assets/query-CSyQ0w5Y.js","assets/vendor-CBH9K-97.js","assets/router-BWB2dKYR.js","assets/ui-qr7cu0yN.js","assets/index-DHe6SDeX.css"])))=>i.map(i=>d[i]);
import{_ as i}from"./index-CWJzhqZF.js";import{a as c}from"./index-ngrFHoWO.js";const h=()=>{const s=c.create({baseURL:"http://localhost:5000/api",timeout:1e4,headers:{"Content-Type":"application/json"}});return s.interceptors.request.use(async e=>{if((localStorage.getItem("authMethod")||"firebase")==="firebase")try{const{auth:t}=await i(async()=>{const{auth:a}=await import("./index-CWJzhqZF.js").then(n=>n.l);return{auth:a}},__vite__mapDeps([0,1,2,3,4,5])),r=t.currentUser;if(r){const a=await r.getIdToken();e.headers.Authorization=`Bearer ${a}`}}catch(t){console.error("Error getting Firebase token:",t)}else{const t=localStorage.getItem("accessToken");t&&(e.headers.Authorization=`Bearer ${t}`)}return e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,async e=>{var t;const o=e.config;if(((t=e.response)==null?void 0:t.status)===401&&!o._retry){o._retry=!0;try{const r=localStorage.getItem("refreshToken");if(r){const a=await c.post("http://localhost:5000/api/auth/refresh",{refreshToken:r}),{accessToken:n}=a.data;return localStorage.setItem("accessToken",n),o.headers.Authorization=`Bearer ${n}`,s(o)}}catch{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/login"}}return Promise.reject(e)}),s},p=h();export{p as a};
