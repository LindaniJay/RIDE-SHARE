var H=Object.defineProperty;var B=(s,e,r)=>e in s?H(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r;var N=(s,e,r)=>B(s,typeof e!="symbol"?e+"":e,r);import{j as t}from"./query-CSyQ0w5Y.js";import{r as c,a as L}from"./vendor-CBH9K-97.js";import{c as W,b,o as q,s as S,d as y,a as k,e as G,f as K,g as J,h as Q}from"./index-DVD4qWsO.js";import{c as X}from"./router-BWB2dKYR.js";import{S as Y}from"./SEO-DM8WR41Z.js";import"./ui-qr7cu0yN.js";const T=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,A=W,U=(s,e)=>r=>{var i;if((e==null?void 0:e.variants)==null)return A(s,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:o,defaultVariants:a}=e,n=Object.keys(o).map(l=>{const h=r==null?void 0:r[l],p=a==null?void 0:a[l];if(h===null)return null;const u=T(h)||T(p);return o[l][u]}),g=r&&Object.entries(r).reduce((l,h)=>{let[p,u]=h;return u===void 0||(l[p]=u),l},{}),d=e==null||(i=e.compoundVariants)===null||i===void 0?void 0:i.reduce((l,h)=>{let{class:p,className:u,...x}=h;return Object.entries(x).every(v=>{let[j,w]=v;return Array.isArray(w)?w.includes({...a,...g}[j]):{...a,...g}[j]===w})?[...l,p,u]:l},[]);return A(s,n,d,r==null?void 0:r.class,r==null?void 0:r.className)},Z=U("rounded-xl border bg-white shadow-sm transition-all duration-200",{variants:{variant:{default:"border-gray-200",elevated:"border-gray-200 shadow-lg hover:shadow-xl",glass:"bg-white/10 backdrop-blur-md border-white/20 text-white",outlined:"border-2 border-gray-300",filled:"bg-gray-50 border-gray-200"},padding:{none:"p-0",sm:"p-4",md:"p-6",lg:"p-8"},hover:{true:"hover:shadow-md cursor-pointer",false:""}},defaultVariants:{variant:"default",padding:"md",hover:!1}}),I=c.forwardRef(({className:s,variant:e,padding:r,hover:i,asChild:o=!1,...a},n)=>{const g=o?L.Fragment:"div";return t.jsx(g,{ref:o?void 0:n,className:b(Z({variant:e,padding:r,hover:i,className:s})),...a})});I.displayName="Card";const O=c.forwardRef(({className:s,...e},r)=>t.jsx("div",{ref:r,className:b("flex flex-col space-y-1.5 p-6",s),...e}));O.displayName="CardHeader";const _=c.forwardRef(({className:s,...e},r)=>t.jsx("h3",{ref:r,className:b("text-lg font-semibold leading-none tracking-tight",s),...e}));_.displayName="CardTitle";const ee=c.forwardRef(({className:s,...e},r)=>t.jsx("p",{ref:r,className:b("text-sm text-gray-500",s),...e}));ee.displayName="CardDescription";const V=c.forwardRef(({className:s,...e},r)=>t.jsx("div",{ref:r,className:b("p-6 pt-0",s),...e}));V.displayName="CardContent";const re=c.forwardRef(({className:s,...e},r)=>t.jsx("div",{ref:r,className:b("flex items-center p-6 pt-0",s),...e}));re.displayName="CardFooter";const se=U("flex w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50 transition-colors duration-200",{variants:{variant:{default:"border-gray-300 focus:ring-blue-500",error:"border-red-500 focus:ring-red-500 focus:border-red-500",success:"border-green-500 focus:ring-green-500 focus:border-green-500",glass:"bg-white/10 backdrop-blur-md border-white/20 text-white placeholder:text-white/60 focus:ring-white/50"},size:{sm:"h-8 px-2 text-xs",md:"h-10 px-3 text-sm",lg:"h-12 px-4 text-base"}},defaultVariants:{variant:"default",size:"md"}}),C=c.forwardRef(({className:s,variant:e,size:r,label:i,error:o,helperText:a,leftIcon:n,rightIcon:g,required:d,id:l,...h},p)=>{const u=l||`input-${Math.random().toString(36).substr(2,9)}`,x=!!o,v=x?"error":e;return t.jsxs("div",{className:"w-full",children:[i&&t.jsxs("label",{htmlFor:u,className:"block text-sm font-medium text-gray-700 mb-1",children:[i,d&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsxs("div",{className:"relative",children:[n&&t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("span",{className:"text-gray-400","aria-hidden":"true",children:n})}),t.jsx("input",{id:u,className:b(se({variant:v,size:r,className:s}),n&&"pl-10",g&&"pr-10"),ref:p,"aria-invalid":x,"aria-describedby":o?`${u}-error`:a?`${u}-helper`:void 0,...h}),g&&t.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:t.jsx("span",{className:"text-gray-400","aria-hidden":"true",children:g})})]}),o&&t.jsx("p",{id:`${u}-error`,className:"mt-1 text-sm text-red-600",role:"alert",children:o}),a&&!o&&t.jsx("p",{id:`${u}-helper`,className:"mt-1 text-sm text-gray-500",children:a})]})});C.displayName="Input";const te=(s,e)=>{switch(e.type){case"SET_FIELD_VALUE":return{...s,fields:{...s.fields,[e.payload.name]:{...s.fields[e.payload.name],value:e.payload.value,touched:!0}},isDirty:!0};case"SET_FIELD_ERROR":return{...s,fields:{...s.fields,[e.payload.name]:{...s.fields[e.payload.name],error:e.payload.error}}};case"CLEAR_FIELD_ERROR":return{...s,fields:{...s.fields,[e.payload.name]:{...s.fields[e.payload.name],error:void 0}}};case"TOUCH_FIELD":return{...s,fields:{...s.fields,[e.payload.name]:{...s.fields[e.payload.name],touched:!0}}};case"SET_SUBMITTING":return{...s,isSubmitting:e.payload};case"RESET_FORM":return{fields:{},isValid:!0,isSubmitting:!1,isDirty:!1};case"SET_FORM_DATA":const r={};return Object.entries(e.payload).forEach(([i,o])=>{r[i]={name:i,value:o,touched:!1}}),{...s,fields:r,isDirty:!1};default:return s}},D=c.createContext(void 0),M=()=>{const s=c.useContext(D);if(!s)throw new Error("useForm must be used within a FormProvider");return s},ae=({children:s,initialValues:e={},onSubmit:r,validationSchema:i,className:o})=>{const[a,n]=c.useReducer(te,{fields:{},isValid:!0,isSubmitting:!1,isDirty:!1}),g=c.useCallback((f,m)=>{n({type:"SET_FIELD_VALUE",payload:{name:f,value:m}})},[]),d=c.useCallback((f,m)=>{n({type:"SET_FIELD_ERROR",payload:{name:f,error:m}})},[]),l=c.useCallback(f=>{n({type:"CLEAR_FIELD_ERROR",payload:{name:f}})},[]),h=c.useCallback(f=>{n({type:"TOUCH_FIELD",payload:{name:f}})},[]),p=c.useCallback(f=>{n({type:"SET_SUBMITTING",payload:f})},[]),u=c.useCallback(()=>{n({type:"RESET_FORM"})},[]),x=c.useCallback(f=>{var m;return(m=a.fields[f])==null?void 0:m.value},[a.fields]),v=c.useCallback(f=>{var m;return(m=a.fields[f])==null?void 0:m.error},[a.fields]),j=c.useCallback(f=>{var m;return((m=a.fields[f])==null?void 0:m.touched)||!1},[a.fields]),w=async f=>{if(f.preventDefault(),!a.isSubmitting){p(!0);try{const m={};if(Object.entries(a.fields).forEach(([E,F])=>{m[E]=F.value}),i){const E=i(m);if(Object.keys(E).length>0){Object.entries(E).forEach(([$,z])=>{d($,z)}),p(!1);return}}await r(m)}catch(m){console.error("Form submission error:",m)}finally{p(!1)}}};L.useEffect(()=>{Object.keys(e).length>0&&n({type:"SET_FORM_DATA",payload:e})},[e]);const P={state:a,setFieldValue:g,setFieldError:d,clearFieldError:l,touchField:h,setSubmitting:p,resetForm:u,getFieldValue:x,getFieldError:v,isFieldTouched:j};return t.jsx(D.Provider,{value:P,children:t.jsx("form",{onSubmit:w,className:b("space-y-6",o),children:s})})},R=({name:s,children:e})=>{const{getFieldValue:r,getFieldError:i,isFieldTouched:o,setFieldValue:a,setFieldError:n,clearFieldError:g,touchField:d}=M(),l={value:r(s),error:i(s),touched:o(s),setValue:h=>a(s,h),setError:h=>n(s,h),clearError:()=>g(s),touch:()=>d(s)};return t.jsx(t.Fragment,{children:e(l)})},ie=({children:s,className:e})=>{const{state:r}=M();return t.jsx("button",{type:"submit",disabled:r.isSubmitting||!r.isValid,className:b("w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",e),children:r.isSubmitting?"Submitting...":s})};class ne{constructor(){N(this,"currentUser",null);N(this,"listeners",[]);q(y,async e=>{if(e)try{const r=await e.getIdToken(),i=await k.post("/auth/verify-firebase-token",{idToken:r});i.success?(this.currentUser=i.data.user,this.notifyListeners()):(console.error("Failed to verify Firebase token:",i.message),await this.signOut())}catch(r){console.error("Firebase auth error:",r),await this.signOut()}else this.currentUser=null,this.notifyListeners()})}async adminLogin(e,r){try{const o=await(await S(y,e,r)).user.getIdToken(),a=await k.post("/auth/verify-firebase-token",{idToken:o});if(a.success){const n=a.data.user;if(n.role!=="admin"&&!n.isAdmin)throw await this.signOut(),new Error("Access denied. Admin privileges required.");return this.currentUser=n,localStorage.setItem("authToken",a.data.accessToken),this.notifyListeners(),this.currentUser}else throw new Error(a.message||"Admin authentication failed")}catch(i){throw console.error("Admin login error:",i),i}}async signIn(e,r){try{const o=await(await S(y,e,r)).user.getIdToken(),a=await k.post("/auth/verify-firebase-token",{idToken:o});if(a.success)return this.currentUser=a.data.user,localStorage.setItem("authToken",a.data.accessToken),this.notifyListeners(),this.currentUser;throw new Error(a.message||"Authentication failed")}catch(i){throw console.error("Sign in error:",i),i}}async signUp(e,r,i,o,a="renter"){try{const n=await G(y,e,r);await K(n.user,{displayName:`${i} ${o}`});const g=await n.user.getIdToken(),d=await k.post("/auth/verify-firebase-token",{idToken:g});if(d.success)return this.currentUser=d.data.user,localStorage.setItem("authToken",d.data.accessToken),this.notifyListeners(),this.currentUser;throw new Error(d.message||"Registration failed")}catch(n){throw console.error("Sign up error:",n),n}}async signOut(){try{await J(y),this.currentUser=null,localStorage.removeItem("authToken"),this.notifyListeners()}catch(e){throw console.error("Sign out error:",e),e}}getCurrentUser(){return this.currentUser}isAuthenticated(){return this.currentUser!==null}isAdmin(){var e,r;return((e=this.currentUser)==null?void 0:e.role)==="admin"||((r=this.currentUser)==null?void 0:r.isAdmin)===!0}isHost(){var e;return((e=this.currentUser)==null?void 0:e.role)==="host"}isRenter(){var e;return((e=this.currentUser)==null?void 0:e.role)==="renter"}onAuthStateChange(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(r=>r!==e)}}notifyListeners(){this.listeners.forEach(e=>e(this.currentUser))}async getIdToken(){return y.currentUser?await y.currentUser.getIdToken():null}async refreshIdToken(){return y.currentUser?await y.currentUser.getIdToken(!0):null}}const oe=new ne,le=({onSuccess:s,className:e})=>{const[r,i]=c.useState(!1),o=X(),{error:a,success:n}=Q(),g=async d=>{i(!0);try{await oe.adminLogin(d.email,d.password),n("Admin login successful","Welcome to the admin dashboard"),s==null||s(),o("/dashboard")}catch(l){a("Admin login failed",l.message||"Invalid admin credentials")}finally{i(!1)}};return t.jsx("div",{className:`min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 ${e}`,children:t.jsxs("div",{className:"max-w-md w-full space-y-8",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-white",children:"Admin Access"}),t.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"Sign in to access the admin dashboard"})]}),t.jsxs(I,{className:"mt-8 bg-white/20 backdrop-blur-md border border-white/30 shadow-2xl",children:[t.jsx(O,{children:t.jsx(_,{className:"text-center text-white",children:"Administrator Login"})}),t.jsx(V,{children:t.jsx(ae,{onSubmit:g,children:t.jsxs("div",{className:"space-y-4",children:[t.jsx(R,{name:"email",children:({value:d,setValue:l,error:h,clearError:p,touch:u})=>t.jsx(C,{label:"Admin Email",type:"email",value:d||"",onChange:x=>{l(x.target.value),p()},onBlur:()=>u(),error:h,placeholder:"admin@rideshare.co.za",required:!0,leftIcon:t.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})})})}),t.jsx(R,{name:"password",children:({value:d,setValue:l,error:h,clearError:p,touch:u})=>t.jsx(C,{label:"Password",type:"password",value:d||"",onChange:x=>{l(x.target.value),p()},onBlur:()=>u(),error:h,placeholder:"Enter admin password",required:!0,leftIcon:t.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})}),t.jsx(ie,{className:"w-full",children:r?"Signing in...":"Sign in as Admin"})]})})})]}),t.jsx("div",{className:"text-center",children:t.jsxs("p",{className:"text-sm text-white/90 bg-white/10 backdrop-blur-md rounded-lg p-3 border border-white/20",children:["Regular users should use"," ",t.jsx("button",{onClick:()=>o("/login"),className:"font-medium text-blue-300 hover:text-blue-200 transition-colors",children:"Firebase authentication"})]})})]})})},pe=()=>t.jsxs(t.Fragment,{children:[t.jsx(Y,{title:"Admin Login - RideShare SA",description:"Administrator access to RideShare SA dashboard",keywords:"admin login, administrator, dashboard, RideShare SA",url:"https://rideshare-sa.co.za/admin-login"}),t.jsx(le,{})]});export{pe as default};
