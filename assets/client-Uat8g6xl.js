const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DRQhGEQP.js","assets/query-CSyQ0w5Y.js","assets/vendor-CBH9K-97.js","assets/router-BWB2dKYR.js","assets/ui-qr7cu0yN.js","assets/index-CUF-SYAf.css"])))=>i.map(i=>d[i]);
import{_ as h}from"./index-DRQhGEQP.js";import{a as i}from"./index-ngrFHoWO.js";const o={BASE_URL:"/RIDE-SHARE/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BASE_PATH:"/RIDE-SHARE/"},l=()=>{const n=i.create({baseURL:(o==null?void 0:o.VITE_API_URL)||"http://localhost:5001/api",timeout:1e4,headers:{"Content-Type":"application/json"}});return n.interceptors.request.use(async e=>{if((localStorage.getItem("authMethod")||"firebase")==="firebase")try{const{auth:t}=await h(async()=>{const{auth:s}=await import("./index-DRQhGEQP.js").then(c=>c.l);return{auth:s}},__vite__mapDeps([0,1,2,3,4,5])),r=t.currentUser;if(r){const s=await r.getIdToken();e.headers.Authorization=`Bearer ${s}`}}catch(t){console.error("Error getting Firebase token:",t)}else{const t=localStorage.getItem("accessToken");t&&(e.headers.Authorization=`Bearer ${t}`)}return e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>{var t;const a=e.config;if(((t=e.response)==null?void 0:t.status)===401&&!a._retry){a._retry=!0;try{const r=localStorage.getItem("refreshToken");if(r){const s=await i.post(`${(o==null?void 0:o.VITE_API_URL)||"http://localhost:5001/api"}/auth/refresh`,{refreshToken:r}),{accessToken:c}=s.data;return localStorage.setItem("accessToken",c),a.headers.Authorization=`Bearer ${c}`,n(a)}}catch{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/login"}}return Promise.reject(e)}),n},f=l();export{f as a};
