import{r as e,j as t,g as s,c as a,f as i,l as r,e as n,m as l,U as c,o,u as d}from"./react-vendor-CsyM86xr.js";import{I as h,u as m,G as x,a as u,n as p,R as g,S as b,E as j,A as w,b as f,c as y,L as v}from"./admin-pages-uBlL0uRW.js";import{l as N}from"./vendor-BLLdzSkb.js";const k=new class{baseURL;token=null;constructor(e="http://localhost:5001/api"){this.baseURL=e,this.token=localStorage.getItem("auth_token")}async request(e,t={}){const s=`${this.baseURL}${e}`,a={"Content-Type":"application/json",...t.headers};this.token&&(a.Authorization=`Bearer ${this.token}`);try{const e=await fetch(s,{...t,headers:a}),i=await e.json();if(!e.ok)throw new Error(i.error||"Request failed");return{data:i}}catch(i){return{error:i instanceof Error?i.message:"Unknown error"}}}async get(e){return this.request(e,{method:"GET"})}async post(e,t){return this.request(e,{method:"POST",body:JSON.stringify(t)})}async put(e,t){return this.request(e,{method:"PUT",body:JSON.stringify(t)})}async delete(e){return this.request(e,{method:"DELETE"})}async uploadFile(e,t,s){const a=new FormData;a.append("file",t),s&&Object.entries(s).forEach(([e,t])=>{a.append(e,String(t))});const i={};this.token&&(i.Authorization=`Bearer ${this.token}`);try{const t=await fetch(`${this.baseURL}${e}`,{method:"POST",headers:i,body:a}),s=await t.json();if(!t.ok)throw new Error(s.error||"Upload failed");return{data:s}}catch(r){return{error:r instanceof Error?r.message:"Unknown error"}}}async register(e){return this.request("/auth/register",{method:"POST",body:JSON.stringify(e)})}async login(e){const t=await this.request("/auth/login",{method:"POST",body:JSON.stringify(e)});return t.data?.token&&(this.token=t.data.token,localStorage.setItem("auth_token",t.data.token)),t}async logout(){this.token=null,localStorage.removeItem("auth_token")}async getProfile(){return this.request("/auth/profile")}async getListings(e){const t=new URLSearchParams;e&&Object.entries(e).forEach(([e,s])=>{void 0!==s&&t.append(e,s.toString())});const s="/listings"+(t.toString()?`?${t.toString()}`:"");return this.request(s)}async getListing(e){return this.request(`/listings/${e}`)}async createListing(e){return this.request("/listings",{method:"POST",body:JSON.stringify(e)})}async updateListing(e,t){return this.request(`/listings/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteListing(e){return this.request(`/listings/${e}`,{method:"DELETE"})}async createBooking(e){return this.request("/bookings",{method:"POST",body:JSON.stringify(e)})}async getMyBookings(){return this.request("/bookings/my-bookings")}async getHostBookings(){return this.request("/bookings/host-bookings")}async updateBookingStatus(e,t,s){return this.request(`/bookings/${e}`,{method:"PUT",body:JSON.stringify({status:t,reason:s})})}async cancelBooking(e,t){return this.request(`/bookings/${e}/cancel`,{method:"POST",body:JSON.stringify({reason:t})})}async createPayment(e){return this.request("/payments",{method:"POST",body:JSON.stringify(e)})}async processPayment(e){return this.request(`/payments/${e}/process`,{method:"POST"})}async getMyPayments(){return this.request("/payments/my-payments")}async createReview(e){return this.request("/reviews",{method:"POST",body:JSON.stringify(e)})}async getListingReviews(e){return this.request(`/reviews/listing/${e}`)}async getAdminLogs(){return this.request("/admin/logs")}async overrideBooking(e,t,s){return this.request("/admin/override-booking",{method:"POST",body:JSON.stringify({booking_id:e,status:t,reason:s})})}async removeListing(e){return this.request(`/admin/listings/${e}`,{method:"DELETE"})}async getNotifications(){return this.request("/notifications")}async markNotificationAsRead(e){return this.request(`/notifications/${e}/read`,{method:"PUT"})}async getDashboardStats(){return this.request("/dashboard/stats")}async getHostStats(){return this.request("/dashboard/host-stats")}async getAdminStats(){return this.request("/dashboard/admin-stats")}},S=new class{bookings=[];listeners=[];constructor(){this.loadBookingsFromStorage()}loadBookingsFromStorage(){const e=localStorage.getItem("rideshare_bookings");if(e)try{this.bookings=JSON.parse(e)}catch(t){this.bookings=[]}}saveBookingsToStorage(){localStorage.setItem("rideshare_bookings",JSON.stringify(this.bookings))}notifyListeners(){this.listeners.forEach(e=>e(this.bookings))}async createBooking(e){try{const t=await k.createBooking(e);if(t.error)return{success:!1,error:t.error};if(t.data){const e=t.data;return this.bookings.push(e),this.saveBookingsToStorage(),this.notifyListeners(),{success:!0,booking:e}}return{success:!1,error:"Booking creation failed"}}catch(t){return{success:!1,error:"Booking creation failed"}}}async getRenterBookings(){try{const e=await k.getMyBookings();return e.data?(this.bookings=e.data,this.saveBookingsToStorage(),this.notifyListeners(),e.data):[]}catch(e){return[]}}async getHostBookings(){try{const e=await k.getHostBookings();return e.data?e.data:[]}catch(e){return[]}}async updateBookingStatus(e,t,s){try{const a=await k.updateBookingStatus(e,t,s);if(a.error)return{success:!1,error:a.error};const i=this.bookings.findIndex(t=>t.id===e);return-1!==i&&(this.bookings[i].status=t,this.saveBookingsToStorage(),this.notifyListeners()),{success:!0}}catch(a){return{success:!1,error:"Status update failed"}}}async cancelBooking(e,t){try{const s=await k.cancelBooking(e,t);if(s.error)return{success:!1,error:s.error};const a=this.bookings.findIndex(t=>t.id===e);return-1!==a&&(this.bookings[a].status="cancelled",this.saveBookingsToStorage(),this.notifyListeners()),{success:!0}}catch(s){return{success:!1,error:"Booking cancellation failed"}}}async getBookingById(e){try{const t=await k.request(`/bookings/${e}`);return t.data?t.data:null}catch(t){return null}}async getBookingsByStatus(e){return this.bookings.filter(t=>t.status===e)}async getBookingsByDateRange(e,t){return this.bookings.filter(s=>{const a=new Date(s.start_date),i=new Date(s.end_date),r=new Date(e),n=new Date(t);return a>=r&&i<=n})}async getBookingsByListing(e){return this.bookings.filter(t=>t.listing_id===e)}async getBookingsByRenter(e){return this.bookings.filter(t=>t.renter_id===e)}async getBookingsByHost(){try{const e=await k.getHostBookings();return e.data?e.data:[]}catch(e){return[]}}async getBookingStats(){return{total:this.bookings.length,pending:this.bookings.filter(e=>"pending"===e.status).length,confirmed:this.bookings.filter(e=>"confirmed"===e.status).length,completed:this.bookings.filter(e=>"completed"===e.status).length,cancelled:this.bookings.filter(e=>"cancelled"===e.status).length}}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}async getAllBookings(){try{const e=await k.request("/bookings");return e.data?e.data:[]}catch(e){return[]}}async searchBookings(e){return this.bookings.filter(t=>t.id.toLowerCase().includes(e.toLowerCase())||t.listing?.title?.toLowerCase().includes(e.toLowerCase())||t.renter?.first_name?.toLowerCase().includes(e.toLowerCase())||t.renter?.last_name?.toLowerCase().includes(e.toLowerCase()))}},C=({src:s,alt:a,className:i="",width:r,height:n,priority:l=!1,placeholder:c="empty",blurDataURL:o,sizes:d="100vw",quality:h=75})=>{const[m,x]=e.useState(!1),[u,p]=e.useState(l),[g,b]=e.useState(!1),j=e.useRef(null);return e.useEffect(()=>{if(l)return;const e=new IntersectionObserver(([t])=>{t.isIntersecting&&(p(!0),e.disconnect())},{threshold:.1,rootMargin:"50px"});return j.current&&e.observe(j.current),()=>e.disconnect()},[l]),g?t.jsx("div",{ref:j,className:`bg-gray-200 flex items-center justify-center ${i}`,style:{width:r,height:n},children:t.jsx("span",{className:"text-gray-400 text-sm",children:"Failed to load"})}):t.jsxs("div",{ref:j,className:`relative overflow-hidden ${i}`,children:["blur"===c&&o&&!m&&t.jsx("div",{className:"absolute inset-0 bg-cover bg-center filter blur-sm scale-110",style:{backgroundImage:`url(${o})`}}),!m&&!o&&t.jsx("div",{className:"absolute inset-0 bg-gray-200 animate-pulse"}),u&&t.jsx("img",{src:(e=>{if(e.startsWith("http")||e.includes("?"))return e;const t=new URLSearchParams;return r&&t.set("w",r.toString()),n&&t.set("h",n.toString()),h&&t.set("q",h.toString()),t.set("f","webp"),`${e}?${t.toString()}`})(s),alt:a,width:r,height:n,sizes:d,loading:l?"eager":"lazy",decoding:"async",onLoad:()=>{x(!0)},onError:()=>{b(!0)},className:"transition-opacity duration-300 "+(m?"opacity-100":"opacity-0"),style:{width:r,height:n}})]})},A=()=>t.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20",children:t.jsxs("div",{className:"animate-pulse",children:[t.jsx("div",{className:"bg-white/20 rounded h-6 w-3/4 mb-4"}),t.jsx("div",{className:"bg-white/20 rounded h-4 w-1/2 mb-2"}),t.jsx("div",{className:"bg-white/20 rounded h-4 w-2/3"})]})}),T=()=>t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Array.from({length:3}).map((e,s)=>t.jsx(A,{},s))}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsx(A,{}),t.jsx(A,{})]})]}),P=({bookingId:o,userRole:d,onStepComplete:h,onStepError:m})=>{const[x,u]=e.useState([]),[p,g]=e.useState(!0),[b,j]=e.useState(null);e.useEffect(()=>{w()},[o]);const w=async()=>{g(!0);try{await new Promise(e=>setTimeout(e,500));const e=[{id:"booking_created",title:"Booking Request Created",description:"Renter submits booking request",status:"completed",timestamp:new Date(Date.now()-72e5),actor:"renter"},{id:"payment_processed",title:"Payment Processed",description:"Payment has been successfully processed",status:"completed",timestamp:new Date(Date.now()-54e5),actor:"system"},{id:"host_notification",title:"Host Notified",description:"Host has been notified of the booking request",status:"completed",timestamp:new Date(Date.now()-36e5),actor:"system"},{id:"host_approval",title:"Awaiting Host Approval",description:"Host needs to approve or decline the booking",status:"current",actor:"host"},{id:"vehicle_preparation",title:"Vehicle Preparation",description:"Host prepares vehicle for rental",status:"pending",actor:"host"},{id:"pickup_handover",title:"Pickup Handover",description:"Vehicle handover to renter",status:"pending",actor:"host"},{id:"rental_period",title:"Active Rental",description:"Rental period in progress",status:"pending",actor:"renter"},{id:"return_handover",title:"Return Handover",description:"Vehicle return to host",status:"pending",actor:"renter"},{id:"booking_complete",title:"Booking Completed",description:"Rental process completed",status:"pending",actor:"system"}];u(e);const t=e.find(e=>"current"===e.status);j(t||null)}catch(e){}finally{g(!1)}},f=e=>{switch(e.status){case"completed":return t.jsx(i,{className:"w-5 h-5 text-green-600"});case"current":return t.jsx(s,{className:"w-5 h-5 text-blue-600"});case"error":return t.jsx(a,{className:"w-5 h-5 text-red-600"});case"skipped":return t.jsx(a,{className:"w-5 h-5 text-gray-400"});default:return t.jsx(s,{className:"w-5 h-5 text-gray-400"})}},y=e=>{switch(e){case"renter":return t.jsx(c,{className:"w-4 h-4 text-blue-600"});case"host":return t.jsx(l,{className:"w-4 h-4 text-green-600"});case"admin":return t.jsx(n,{className:"w-4 h-4 text-purple-600"});case"system":return t.jsx(r,{className:"w-4 h-4 text-gray-600"});default:return t.jsx(s,{className:"w-4 h-4 text-gray-600"})}},v=e=>{switch(e){case"renter":return"Renter";case"host":return"Host";case"admin":return"Admin";case"system":return"System";default:return"Unknown"}},N=e=>{const t=(new Date).getTime()-e.getTime(),s=Math.floor(t/6e4),a=Math.floor(t/36e5),i=Math.floor(t/864e5);return s<1?"Just now":s<60?`${s}m ago`:a<24?`${a}h ago`:`${i}d ago`},k=()=>x.filter(e=>"completed"===e.status).length/x.length*100;return p?t.jsx("div",{className:"flex items-center justify-center h-32",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Booking Workflow"}),t.jsxs("div",{className:"text-sm text-gray-600",children:[Math.round(k()),"% Complete"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:t.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${k()}%`}})}),b&&t.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(s,{className:"w-4 h-4 text-blue-600"}),t.jsx("span",{className:"font-medium text-blue-800",children:"Current Step"})]}),t.jsx("p",{className:"text-blue-700 text-sm",children:b.title}),t.jsx("p",{className:"text-blue-600 text-xs",children:b.description})]})]}),t.jsx("div",{className:"space-y-4",children:x.map(e=>t.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-lg border transition-all "+("completed"===e.status?"bg-green-50 border-green-200":"current"===e.status?"bg-blue-50 border-blue-200":"error"===e.status?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"),children:[t.jsx("div",{className:"flex-shrink-0 mt-1",children:f(e)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("h4",{className:"font-medium "+("completed"===e.status?"text-green-800":"current"===e.status?"text-blue-800":"error"===e.status?"text-red-800":"text-gray-600"),children:e.title}),t.jsxs("div",{className:"flex items-center gap-1",children:[y(e.actor),t.jsx("span",{className:"text-xs text-gray-500",children:v(e.actor)})]})]}),t.jsx("p",{className:"text-sm "+("completed"===e.status?"text-green-700":"current"===e.status?"text-blue-700":"error"===e.status?"text-red-700":"text-gray-500"),children:e.description}),e.timestamp&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:N(e.timestamp)}),e.data&&e.data.reason&&t.jsxs("div",{className:"mt-2 p-2 bg-red-100 border border-red-200 rounded text-sm text-red-700",children:[t.jsx("strong",{children:"Reason:"})," ",e.data.reason]})]}),"current"===e.status&&d===e.actor&&t.jsx("div",{className:"flex-shrink-0",children:t.jsx("button",{onClick:()=>h?.(e.id),className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors",children:"Complete"})})]},e.id))}),b&&t.jsxs("div",{className:"mt-6 flex gap-3",children:["host"===d&&"host"===b.actor&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>h?.(b.id,{action:"approve"}),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Approve Booking"}),t.jsx("button",{onClick:()=>m?.(b.id,"Booking declined"),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Decline Booking"})]}),"renter"===d&&"renter"===b.actor&&t.jsx("button",{onClick:()=>h?.(b.id),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Mark as Complete"}),"admin"===d&&t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>h?.(b.id,{action:"admin_override"}),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Admin Override"}),t.jsx("button",{onClick:()=>m?.(b.id,"Admin intervention required"),className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:"Flag Issue"})]})]})]})},D=({label:s,name:a,required:i=!1,acceptedTypes:r=["image/*","application/pdf"],maxSize:n=5,onChange:l,value:c,error:o,description:d})=>{const[m,x]=e.useState(!1),[u,p]=e.useState(null),g=e.useRef(null),b=e=>{p(null),e.size>1024*n*1024?p(`File size must be less than ${n}MB`):r.some(t=>t.endsWith("/*")?e.type.startsWith(t.slice(0,-1)):e.type===t)?l(e):p(`File type must be one of: ${r.join(", ")}`)};return t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{className:"block text-sm font-medium text-white/80",children:[s,i&&t.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),d&&t.jsx("p",{className:"text-xs text-white/60",children:d}),t.jsxs("div",{className:"relative border-2 border-dashed rounded-lg p-6 transition-all duration-200 "+(m?"border-blue-400 bg-blue-50/10":o||u?"border-red-400 bg-red-50/10":"border-white/20 hover:border-white/40"),onDrop:e=>{e.preventDefault(),x(!1);const t=Array.from(e.dataTransfer.files);t.length>0&&b(t[0])},onDragOver:e=>{e.preventDefault(),x(!0)},onDragLeave:e=>{e.preventDefault(),x(!1)},children:[c?t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"flex items-center justify-center mb-2",children:t.jsx(h,{name:"FileText",size:"lg",className:"text-green-400"})}),t.jsx("p",{className:"text-sm text-white/80 font-medium",children:c.name}),t.jsx("p",{className:"text-xs text-white/60",children:(e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]})(c.size)}),t.jsx("button",{type:"button",onClick:()=>{l(null),g.current&&(g.current.value="")},className:"mt-2 text-red-400 hover:text-red-300 text-xs underline",children:"Remove file"})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"flex items-center justify-center mb-2",children:t.jsx(h,{name:"Upload",size:"lg",className:"text-white/60"})}),t.jsx("p",{className:"text-sm text-white/80",children:m?"Drop file here":"Drag and drop or click to upload"}),t.jsxs("p",{className:"text-xs text-white/60 mt-1",children:["Accepted: ",r.join(", ")," (max ",n,"MB)"]}),t.jsx("button",{type:"button",onClick:()=>g.current?.click(),className:"mt-3 px-4 py-2 bg-white/10 hover:bg-white/20 text-white text-sm rounded-lg transition-colors",children:"Choose File"})]}),t.jsx("input",{ref:g,type:"file",name:a,accept:r.join(","),onChange:e=>{const t=e.target.files;t&&t.length>0&&b(t[0])},className:"hidden"})]}),(o||u)&&t.jsxs("p",{className:"text-xs text-red-400 flex items-center",children:[t.jsx(h,{name:"AlertCircle",size:"sm",className:"mr-1"}),o||u]})]})},B=({userId:s,className:a=""})=>{const[i,r]=e.useState([]),[n,l]=e.useState(!0);e.useEffect(()=>{c()},[s]);const c=async()=>{try{const e=localStorage.getItem("authToken"),t=await fetch(`/api/users/${s}/saved-vehicles`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(t.ok){const e=await t.json();r(e.vehicles||[])}}catch(e){r([{id:"1",hostId:"host1",make:"Toyota",model:"Hilux",year:2022,type:"bakkie",pricePerDay:250,dailyRate:250,location:"Cape Town",images:["https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?w=400"],features:[],status:"approved",approvalStatus:"approved",description:"Perfect for your South African adventure!",fuelType:"petrol",transmission:"manual",seats:5,doors:4,isAvailable:!0,rating:4.8,reviewCount:24,createdAt:new Date,updatedAt:new Date}])}finally{l(!1)}};return n?t.jsx("div",{className:`space-y-4 ${a}`,children:[...Array(3)].map((e,s)=>t.jsx("div",{className:"animate-pulse",children:t.jsx("div",{className:"h-32 bg-white/10 rounded-xl"})},s))}):t.jsx("div",{className:`space-y-4 ${a}`,children:0===i.length?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(h,{name:"Heart",size:"lg",className:"text-white/50 mb-4"}),t.jsx("p",{className:"text-white/70",children:"No saved vehicles yet"}),t.jsx("p",{className:"text-white/50 text-sm",children:"Browse vehicles and save your favorites!"})]}):i.map(e=>t.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-4 border border-white/20 hover:bg-white/20 transition-all duration-300",children:t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("img",{src:e.images[0],alt:`${e.make} ${e.model}`,className:"w-20 h-20 object-cover rounded-lg"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("h3",{className:"text-lg font-semibold text-white",children:[e.year," ",e.make," ",e.model]}),t.jsx("p",{className:"text-white/70 text-sm mb-2",children:e.location}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("span",{className:"text-yellow-400 flex items-center space-x-1",children:[t.jsx(h,{name:"Star",size:"sm"}),t.jsx("span",{children:e.rating})]}),t.jsxs("span",{className:"text-white/70",children:["(",e.reviewCount," reviews)"]}),t.jsxs("span",{className:"text-green-400 font-semibold",children:["R",e.pricePerDay,"/day"]})]})]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{className:"px-3 py-1 bg-blue-500/20 text-blue-300 rounded-lg text-sm hover:bg-blue-500/30 transition-colors",children:"View Details"}),t.jsx("button",{onClick:()=>(async e=>{try{const t=localStorage.getItem("authToken");await fetch(`/api/users/${s}/saved-vehicles/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}}),r(t=>t.filter(t=>t.id!==e))}catch(t){}})(e.id),className:"px-3 py-1 bg-red-500/20 text-red-300 rounded-lg text-sm hover:bg-red-500/30 transition-colors",children:"Remove"})]})]})},e.id))})},$=({userId:s,className:a=""})=>{const[i,r]=e.useState([]),[n,l]=e.useState(!0);e.useEffect(()=>{c()},[s]);const c=async()=>{try{const e=localStorage.getItem("authToken"),t=await fetch(`/api/users/${s}/documents`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(t.ok){const e=await t.json();r(e.documents||[])}}catch(e){r([{id:"1",type:"driver_license",name:"Driver License",expiryDate:new Date(Date.now()+2592e6),status:"expiring_soon",daysUntilExpiry:30},{id:"2",type:"id_document",name:"South African ID",expiryDate:new Date(Date.now()+31536e6),status:"valid",daysUntilExpiry:365}])}finally{l(!1)}},o=e=>{switch(e){case"expired":return"text-red-400 bg-red-500/20 border-red-500/30";case"expiring_soon":return"text-yellow-400 bg-yellow-500/20 border-yellow-500/30";case"valid":return"text-green-400 bg-green-500/20 border-green-500/30";default:return"text-gray-400 bg-gray-500/20 border-gray-500/30"}},d=e=>{switch(e){case"expired":return"XCircle";case"expiring_soon":return"AlertTriangle";case"valid":return"CheckCircle";default:return"FileText"}},m=e=>{switch(e){case"driver_license":return"Car";case"id_document":return"CreditCard";case"proof_of_address":return"Home";default:return"FileText"}};return n?t.jsx("div",{className:`space-y-3 ${a}`,children:[...Array(2)].map((e,s)=>t.jsx("div",{className:"animate-pulse",children:t.jsx("div",{className:"h-16 bg-white/10 rounded-lg"})},s))}):t.jsx("div",{className:`space-y-3 ${a}`,children:0===i.length?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(h,{name:"FileText",size:"lg",className:"text-white/50 mb-2"}),t.jsx("p",{className:"text-white/70 text-sm",children:"No documents uploaded yet"})]}):i.map(e=>t.jsx("div",{className:`p-3 rounded-lg border ${o(e.status)}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(h,{name:m(e.type),size:"sm"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-white",children:e.name}),t.jsxs("p",{className:"text-xs text-white/70",children:["Expires: ",e.expiryDate.toLocaleDateString()]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(h,{name:d(e.status),size:"sm"}),t.jsx("span",{className:"text-xs",children:"expired"===e.status?"Expired":"expiring_soon"===e.status?`${e.daysUntilExpiry} days`:"Valid"})]}),"expiring_soon"===e.status&&t.jsx("button",{className:"text-xs text-blue-400 hover:text-blue-300 transition-colors mt-1",children:"Renew Now"})]})]})},e.id))})},R=({userId:s,className:a=""})=>{const[i,r]=e.useState([]),[n,l]=e.useState(!0),[c,o]=e.useState("");e.useEffect(()=>{d()},[s]);const d=async()=>{try{const e=localStorage.getItem("authToken"),t=await fetch(`/api/users/${s}/promotions`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(t.ok){const e=await t.json();r(e.promotions||[])}}catch(e){r([{id:"1",code:"WELCOME20",title:"Welcome Bonus",description:"20% off your first booking",discountType:"percentage",discountValue:20,minBookingAmount:500,validUntil:new Date(Date.now()+2592e6),isActive:!0,usageCount:0,maxUsage:1},{id:"2",code:"SAVE100",title:"Fixed Discount",description:"R100 off bookings over R1000",discountType:"fixed",discountValue:100,minBookingAmount:1e3,validUntil:new Date(Date.now()+12096e5),isActive:!0,usageCount:0,maxUsage:3}])}finally{l(!1)}},m=e=>"percentage"===e.discountType?`${e.discountValue}% off`:`R${e.discountValue} off`,x=e=>new Date>e;return n?t.jsx("div",{className:`space-y-3 ${a}`,children:[...Array(2)].map((e,s)=>t.jsx("div",{className:"animate-pulse",children:t.jsx("div",{className:"h-20 bg-white/10 rounded-lg"})},s))}):t.jsx("div",{className:`space-y-4 ${a}`,children:0===i.length?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(h,{name:"Gift",size:"lg",className:"text-white/50 mb-2"}),t.jsx("p",{className:"text-white/70 text-sm",children:"No promotions available"})]}):i.map(e=>t.jsxs("div",{className:"p-4 rounded-lg border "+(x(e.validUntil)?"bg-gray-500/20 border-gray-500/30":"bg-green-500/20 border-green-500/30"),children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(h,{name:"Gift",size:"sm"}),t.jsx("span",{className:"font-semibold text-white",children:e.title}),t.jsxs("span",{className:"text-xs text-white/70",children:["(",e.code,")"]})]}),t.jsx("span",{className:"text-sm font-bold "+(x(e.validUntil)?"text-gray-400":"text-green-400"),children:m(e)})]}),t.jsx("p",{className:"text-sm text-white/80 mb-3",children:e.description}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"text-xs text-white/60",children:["Valid until: ",e.validUntil.toLocaleDateString(),e.minBookingAmount&&t.jsxs("span",{className:"ml-2",children:["• Min: R",e.minBookingAmount]})]}),!x(e.validUntil)&&t.jsx("button",{onClick:()=>(async e=>{try{const t=localStorage.getItem("authToken");(await fetch(`/api/users/${s}/promotions/apply`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({code:e})})).ok&&o(e)}catch(t){}})(e.code),className:"px-3 py-1 rounded-lg text-xs font-medium transition-colors "+(c===e.code?"bg-blue-500/20 text-blue-300":"bg-white/10 text-white hover:bg-white/20"),children:c===e.code?"Applied":"Use Code"})]})]},e.id))})},z=({basePrice:s,onCalculate:a,className:i=""})=>{const[r,n]=e.useState("daily"),[l,c]=e.useState(1),[d,m]=e.useState({insurance:!1,gps:!1,childSeat:!1,driver:!1,fuel:!1}),x={insurance:50,gps:30,childSeat:25,driver:200,fuel:100},u=()=>{let e=s*l;"hourly"===r?e=s*l:"weekly"===r&&(e=s*l*7*.85);let t=0;const i=Object.entries(d).filter(([e,t])=>t).map(([e,t])=>({name:e,price:x[e]}));t=i.reduce((e,t)=>e+t.price,0);const n=.1*(e+t),c=e+t+n,o={baseTotal:e,addOns:i,addOnTotal:t,serviceFee:n,total:c,rentalType:r,duration:l};return a(c,o),o};return o.useEffect(()=>{u()},[r,l,d,s]),t.jsxs("div",{className:`space-y-4 ${i}`,children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/90 mb-2",children:"Rental Type"}),t.jsx("div",{className:"flex space-x-2",children:[{value:"hourly",label:"Hourly",icon:"Clock"},{value:"daily",label:"Daily",icon:"Calendar"},{value:"weekly",label:"Weekly",icon:"Calendar"}].map(e=>t.jsxs("button",{onClick:()=>n(e.value),className:"flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-all "+(r===e.value?"bg-blue-500/20 text-blue-300 border border-blue-500/30":"bg-white/10 text-white/70 border border-white/20 hover:bg-white/20"),children:[t.jsx(h,{name:e.icon,size:"sm",className:"mr-1"}),e.label]},e.value))})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-white/90 mb-2",children:["Duration (","hourly"===r?"Hours":"daily"===r?"Days":"Weeks",")"]}),t.jsx("input",{type:"number",min:"1",value:l,onChange:e=>c(parseInt(e.target.value)||1),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/20"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/90 mb-2",children:"Add-ons"}),t.jsx("div",{className:"space-y-2",children:[{key:"insurance",label:"Comprehensive Insurance",icon:"Shield",price:x.insurance},{key:"gps",label:"GPS Navigation",icon:"MapPin",price:x.gps},{key:"childSeat",label:"Child Safety Seat",icon:"Baby",price:x.childSeat},{key:"driver",label:"Professional Driver",icon:"User",price:x.driver},{key:"fuel",label:"Full Tank of Fuel",icon:"Fuel",price:x.fuel}].map(e=>t.jsxs("label",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors cursor-pointer",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("input",{type:"checkbox",checked:d[e.key],onChange:t=>((e,t)=>{m(s=>({...s,[e]:t}))})(e.key,t.target.checked),className:"w-4 h-4 text-blue-600 bg-white/10 border-white/20 rounded focus:ring-blue-500"}),t.jsx(h,{name:e.icon,size:"sm"}),t.jsx("span",{className:"text-white/90 text-sm",children:e.label})]}),t.jsxs("span",{className:"text-white/70 text-sm",children:["R",e.price]})]},e.key))})]}),t.jsxs("div",{className:"bg-white/10 rounded-lg p-4 border border-white/20",children:[t.jsx("h4",{className:"text-sm font-medium text-white/90 mb-3",children:"Cost Breakdown"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"text-white/70",children:["Base (",r,"):"]}),t.jsxs("span",{className:"text-white",children:["R",s," × ",l]})]}),Object.entries(d).filter(([e,t])=>t).map(([e,s])=>t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"text-white/70 capitalize",children:[e.replace(/([A-Z])/g," $1"),":"]}),t.jsxs("span",{className:"text-white",children:["R",x[e]]})]},e)),t.jsxs("div",{className:"flex justify-between border-t border-white/20 pt-2",children:[t.jsx("span",{className:"text-white/70",children:"Service Fee (10%):"}),t.jsxs("span",{className:"text-white",children:["R",Math.round(s*l*.1)]})]}),t.jsxs("div",{className:"flex justify-between font-semibold text-lg border-t border-white/20 pt-2",children:[t.jsx("span",{className:"text-white",children:"Total:"}),t.jsxs("span",{className:"text-green-400",children:["R",Math.round(u().total)]})]})]})]})]})};class I{static baseUrl="/api/messaging";static async sendMessage(e,t,s="text",a){try{const i=new FormData;i.append("content",t),i.append("messageType",s),a&&a.forEach(e=>{i.append("attachments",e)});const r=await fetch(`${this.baseUrl}/conversations/${e}/messages`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:i});if(!r.ok)throw new Error("Failed to send message");return await r.json()}catch(i){throw i}}static async getMessages(e,t=1,s=50){try{const a=await fetch(`${this.baseUrl}/conversations/${e}/messages?page=${t}&limit=${s}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(!a.ok)throw new Error("Failed to fetch messages");return(await a.json()).messages}catch(a){throw a}}static async markMessageAsRead(e){try{await fetch(`${this.baseUrl}/messages/${e}/read`,{method:"PATCH",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}})}catch(t){}}static async getConversations(){try{const e=await fetch(`${this.baseUrl}/conversations`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(!e.ok)throw new Error("Failed to fetch conversations");return(await e.json()).conversations}catch(e){throw e}}static async createConversation(e){try{const t=await fetch(`${this.baseUrl}/conversations`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify({participantIds:e})});if(!t.ok)throw new Error("Failed to create conversation");return await t.json()}catch(t){throw t}}static async createSupportTicket(e){try{const t=await fetch(`${this.baseUrl}/support-tickets`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to create support ticket");return await t.json()}catch(t){throw t}}static async getSupportTickets(e,t){try{const s=new URLSearchParams;e&&s.append("status",e),t&&s.append("priority",t);const a=await fetch(`${this.baseUrl}/support-tickets?${s}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(!a.ok)throw new Error("Failed to fetch support tickets");return(await a.json()).tickets}catch(s){throw s}}static async updateSupportTicket(e,t){try{const s=await fetch(`${this.baseUrl}/support-tickets/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify(t)});if(!s.ok)throw new Error("Failed to update support ticket");return await s.json()}catch(s){throw s}}static async addMessageToTicket(e,t){try{const s=await fetch(`${this.baseUrl}/support-tickets/${e}/messages`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify({content:t})});if(!s.ok)throw new Error("Failed to add message to ticket");return await s.json()}catch(s){throw s}}}const E=new class{socket=null;baseUrl;constructor(){this.baseUrl="http://localhost:5001"}connect(e){this.socket?.connected||(this.socket=N(this.baseUrl,{auth:{token:e},transports:["websocket","polling"]}),this.socket.on("connect",()=>{}),this.socket.on("disconnect",()=>{}),this.socket.on("error",e=>{}))}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null)}subscribeToNotifications(e){this.socket&&this.socket.on("notification",e)}subscribeToAdminUpdates(e){this.socket&&this.socket.on("admin_update",e)}subscribeToRenterUpdates(e){this.socket&&this.socket.on("renter_update",e)}sendMessage(e){this.socket&&this.socket.emit("message",e)}joinRoom(e){this.socket&&this.socket.emit("join_room",e)}leaveRoom(e){this.socket&&this.socket.emit("leave_room",e)}},L=({conversationId:s,onConversationSelect:a})=>{const{user:i}=m(),[r,n]=e.useState([]),[l,c]=e.useState(null),[o,d]=e.useState([]),[x,u]=e.useState(""),[p,g]=e.useState(!0),[b,j]=e.useState(!1),w=e.useRef(null);e.useEffect(()=>{f(),E.subscribeToNotifications(e=>{"message"===e.type&&(f(),l&&y(l.id))})},[]),e.useEffect(()=>{if(s){const e=r.find(e=>e.id===s);e&&(c(e),y(s))}},[s,r]),e.useEffect(()=>{N()},[o]);const f=async()=>{try{g(!0);const e=await I.getConversations();n(e)}catch(e){}finally{g(!1)}},y=async e=>{try{const t=await I.getMessages(e);d(t)}catch(t){}},v=async()=>{if(x.trim()&&l&&!b)try{j(!0);const e=await I.sendMessage(l.id,x.trim());d(t=>[...t,e]),u(""),await f()}catch(e){}finally{j(!1)}},N=()=>{w.current?.scrollIntoView({behavior:"smooth"})};return p?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"flex h-96 bg-white/5 rounded-xl overflow-hidden",children:[t.jsxs("div",{className:"w-1/3 border-r border-white/10",children:[t.jsx("div",{className:"p-4 border-b border-white/10",children:t.jsx("h3",{className:"text-lg font-semibold text-white",children:"Messages"})}),t.jsx("div",{className:"overflow-y-auto",children:r.map(e=>t.jsx("div",{onClick:()=>(e=>{c(e),y(e.id),a&&a(e.id)})(e),className:"p-4 border-b border-white/5 cursor-pointer hover:bg-white/5 transition-colors "+(l?.id===e.id?"bg-white/10":""),children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:t.jsx(h,{name:"User",size:"sm",className:"text-white"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("p",{className:"text-white font-medium truncate",children:e.participants.filter(e=>e.id!==Number(i?.id)).map(e=>e.name).join(", ")}),e.unreadCount>0&&t.jsx("span",{className:"bg-blue-500 text-white text-xs rounded-full px-2 py-1",children:e.unreadCount})]}),e.lastMessage&&t.jsx("p",{className:"text-gray-400 text-sm truncate",children:e.lastMessage.content})]})]})},e.id))})]}),t.jsx("div",{className:"flex-1 flex flex-col",children:l?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"p-4 border-b border-white/10",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:t.jsx(h,{name:"User",size:"sm",className:"text-white"})}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-medium",children:l.participants.filter(e=>e.id!==Number(i?.id)).map(e=>e.name).join(", ")}),t.jsx("p",{className:"text-gray-400 text-sm",children:l.participants.filter(e=>e.id!==Number(i?.id)).map(e=>e.role).join(", ")})]})]})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[o.map(e=>t.jsx("div",{className:"flex "+(e.senderId===Number(i?.id)?"justify-end":"justify-start"),children:t.jsxs("div",{className:"max-w-xs lg:max-w-md px-4 py-2 rounded-lg "+(e.senderId===Number(i?.id)?"bg-blue-500 text-white":"bg-white/10 text-white"),children:[t.jsx("p",{className:"text-sm",children:e.content}),t.jsx("p",{className:"text-xs mt-1 "+(e.senderId===Number(i?.id)?"text-blue-100":"text-gray-400"),children:new Date(e.timestamp).toLocaleTimeString()})]})},e.id)),t.jsx("div",{ref:w})]}),t.jsx("div",{className:"p-4 border-t border-white/10",children:t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("input",{type:"text",value:x,onChange:e=>u(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),v())},placeholder:"Type a message...",className:"flex-1 px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:b}),t.jsx("button",{onClick:v,disabled:!x.trim()||b,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:b?t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):t.jsx(h,{name:"Send",size:"sm"})})]})})]}):t.jsx("div",{className:"flex-1 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(h,{name:"MessageCircle",size:"lg",className:"text-white/50 mx-auto mb-4"}),t.jsx("p",{className:"text-white/70",children:"Select a conversation to start messaging"})]})})})]})},U=({value:s,onChange:a,placeholder:i="Enter password",label:r,error:n,showStrength:l=!1,className:c="",disabled:o=!1,required:d=!1})=>{const[m,x]=e.useState(!1),[u,p]=e.useState(!1),g=l?(e=>{if(!e)return{score:0,label:"",color:""};let t=0;return e.length>=8&&t++,/[a-z]/.test(e)&&t++,/[A-Z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[^A-Za-z0-9]/.test(e)&&t++,t<=2?{score:t,label:"Weak",color:"text-red-400"}:t<=3?{score:t,label:"Fair",color:"text-yellow-400"}:t<=4?{score:t,label:"Good",color:"text-blue-400"}:{score:t,label:"Strong",color:"text-green-400"}})(s):null;return t.jsxs("div",{className:`space-y-2 ${c}`,children:[r&&t.jsxs("label",{className:"block text-sm font-medium text-white/80",children:[r,d&&t.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:m?"text":"password",value:s,onChange:e=>a(e.target.value),onFocus:()=>p(!0),onBlur:()=>p(!1),placeholder:i,disabled:o,className:`\n            w-full px-4 py-3 pr-12 bg-white/10 border rounded-xl text-white placeholder-white/50 \n            focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all duration-300\n            ${n?"border-red-400 focus:ring-red-500/50":"border-white/20 focus:border-blue-400 hover:border-white/30"}\n            ${o?"opacity-50 cursor-not-allowed":"hover:bg-white/15"}\n            ${u?"bg-white/15":""}\n            backdrop-blur-md\n          `}),t.jsx("button",{type:"button",onClick:()=>x(!m),disabled:o,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-white/50 hover:text-white/80 transition-colors disabled:cursor-not-allowed",children:t.jsx(h,{name:m?"EyeOff":"Eye",size:"sm"})})]}),l&&s&&t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"flex-1 bg-white/10 rounded-full h-1",children:t.jsx("div",{className:"h-1 rounded-full transition-all duration-300 "+((g?.score||0)<=2?"bg-red-400":(g?.score||0)<=3?"bg-yellow-400":(g?.score||0)<=4?"bg-blue-400":"bg-green-400"),style:{width:20*(g?.score||0)+"%"}})}),t.jsx("span",{className:`text-xs font-medium ${g?.color||""}`,children:g?.label||""})]}),n&&t.jsxs("div",{className:"flex items-center space-x-1 text-red-400 text-xs",children:[t.jsx(h,{name:"AlertCircle",size:"xs"}),t.jsx("span",{children:n})]}),l&&t.jsx("div",{className:"text-xs text-white/60",children:t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsxs("span",{className:"flex items-center space-x-1 "+(s.length>=8?"text-green-400":"text-white/40"),children:[t.jsx(h,{name:s.length>=8?"CheckCircle":"Circle",size:"xs"}),t.jsx("span",{children:"8+ chars"})]}),t.jsxs("span",{className:"flex items-center space-x-1 "+(/[a-z]/.test(s)?"text-green-400":"text-white/40"),children:[t.jsx(h,{name:/[a-z]/.test(s)?"CheckCircle":"Circle",size:"xs"}),t.jsx("span",{children:"lower"})]}),t.jsxs("span",{className:"flex items-center space-x-1 "+(/[A-Z]/.test(s)?"text-green-400":"text-white/40"),children:[t.jsx(h,{name:/[A-Z]/.test(s)?"CheckCircle":"Circle",size:"xs"}),t.jsx("span",{children:"UPPER"})]}),t.jsxs("span",{className:"flex items-center space-x-1 "+(/[0-9]/.test(s)?"text-green-400":"text-white/40"),children:[t.jsx(h,{name:/[0-9]/.test(s)?"CheckCircle":"Circle",size:"xs"}),t.jsx("span",{children:"123"})]}),t.jsxs("span",{className:"flex items-center space-x-1 "+(/[^A-Za-z0-9]/.test(s)?"text-green-400":"text-white/40"),children:[t.jsx(h,{name:/[^A-Za-z0-9]/.test(s)?"CheckCircle":"Circle",size:"xs"}),t.jsx("span",{children:"!@#"})]})]})})]})},q=()=>{const{user:s}=m(),[a,i]=e.useState("profile"),[r,n]=e.useState(!1),[l,c]=e.useState(""),[o,d]=e.useState(""),[x,u]=e.useState({firstName:s?.firstName||"",lastName:s?.lastName||"",email:s?.email||"",phone:s?.phoneNumber||""}),[p,g]=e.useState({currentPassword:"",newPassword:"",confirmPassword:""});return t.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Profile Settings"}),t.jsx("p",{className:"text-white/70",children:"Manage your account settings and preferences"})]}),t.jsx("div",{className:"mb-6",children:t.jsx("div",{className:"flex space-x-1 bg-white/10 backdrop-blur-md rounded-lg p-1 border border-white/20",children:[{id:"profile",label:"Profile",icon:"User"},{id:"password",label:"Password",icon:"Lock"},{id:"security",label:"Security",icon:"Shield"}].map(e=>t.jsxs("button",{onClick:()=>i(e.id),className:"flex items-center space-x-2 px-4 py-2 rounded-md transition-all "+(a===e.id?"bg-white/20 text-white":"text-gray-300 hover:text-white hover:bg-white/10"),children:[t.jsx(h,{name:e.icon,className:"h-4 w-4"}),t.jsx("span",{children:e.label})]},e.id))})}),l&&t.jsx("div",{className:"mb-4 p-4 bg-green-500/20 border border-green-400/30 rounded-lg",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(h,{name:"CheckCircle",className:"h-5 w-5 text-green-400"}),t.jsx("span",{className:"text-green-200",children:l})]})}),o&&t.jsx("div",{className:"mb-4 p-4 bg-red-500/20 border border-red-400/30 rounded-lg",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(h,{name:"AlertCircle",className:"h-5 w-5 text-red-400"}),t.jsx("span",{className:"text-red-200",children:o})]})}),t.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-lg border border-white/20",children:["profile"===a&&t.jsxs("div",{className:"p-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:"Profile Information"}),t.jsxs("form",{onSubmit:async e=>{e.preventDefault(),n(!0),d(""),c("");try{const e=await fetch("/api/users/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify(x)});if(e.ok)c("Profile updated successfully");else{const t=await e.json();d(t.error||"Failed to update profile")}}catch(t){d("Failed to update profile")}finally{n(!1)}},className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"First Name"}),t.jsx("input",{type:"text",value:x.firstName,onChange:e=>u({...x,firstName:e.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-400 transition-all",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Last Name"}),t.jsx("input",{type:"text",value:x.lastName,onChange:e=>u({...x,lastName:e.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-400 transition-all",required:!0})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Email Address"}),t.jsx("input",{type:"email",value:x.email,onChange:e=>u({...x,email:e.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-400 transition-all",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Phone Number"}),t.jsx("input",{type:"tel",value:x.phone,onChange:e=>u({...x,phone:e.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-400 transition-all",placeholder:"+27 82 123 4567"})]}),t.jsx("button",{type:"submit",disabled:r,className:"px-6 py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Updating...":"Update Profile"})]})]}),"password"===a&&t.jsxs("div",{className:"p-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:"Change Password"}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),n(!0),d(""),c(""),p.newPassword!==p.confirmPassword)return d("New passwords do not match"),void n(!1);if(p.newPassword.length<8)return d("New password must be at least 8 characters long"),void n(!1);try{const e=await fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify({currentPassword:p.currentPassword,newPassword:p.newPassword})});if(e.ok)c("Password changed successfully"),g({currentPassword:"",newPassword:"",confirmPassword:""});else{const t=await e.json();d(t.error||"Failed to change password")}}catch(t){d("Failed to change password")}finally{n(!1)}},className:"space-y-6",children:[t.jsx(U,{value:p.currentPassword,onChange:e=>g({...p,currentPassword:e}),label:"Current Password",placeholder:"Enter your current password",required:!0}),t.jsx(U,{value:p.newPassword,onChange:e=>g({...p,newPassword:e}),label:"New Password",placeholder:"Enter your new password",showStrength:!0,required:!0}),t.jsx(U,{value:p.confirmPassword,onChange:e=>g({...p,confirmPassword:e}),label:"Confirm New Password",placeholder:"Confirm your new password",required:!0}),t.jsx("button",{type:"submit",disabled:r,className:"px-6 py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Changing...":"Change Password"})]})]}),"security"===a&&t.jsxs("div",{className:"p-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:"Security Settings"}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:[t.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Two-Factor Authentication"}),t.jsx("p",{className:"text-white/70 text-sm mb-4",children:"Add an extra layer of security to your account"}),t.jsx("button",{className:"px-4 py-2 bg-blue-500/20 text-blue-200 rounded-lg hover:bg-blue-500/30 transition-colors",children:"Enable 2FA"})]}),t.jsxs("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:[t.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Login Sessions"}),t.jsx("p",{className:"text-white/70 text-sm mb-4",children:"Manage your active login sessions"}),t.jsx("button",{className:"px-4 py-2 bg-red-500/20 text-red-200 rounded-lg hover:bg-red-500/30 transition-colors",children:"Sign Out All Devices"})]}),t.jsxs("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:[t.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Account Deletion"}),t.jsx("p",{className:"text-white/70 text-sm mb-4",children:"Permanently delete your account and all associated data"}),t.jsx("button",{className:"px-4 py-2 bg-red-500/20 text-red-200 rounded-lg hover:bg-red-500/30 transition-colors",children:"Delete Account"})]})]})]})]})]})},V=({requestType:s,entityId:a,submittedBy:i,onSuccess:r,onCancel:n,title:l,description:c})=>{const[o,d]=e.useState(""),[m,g]=e.useState(!1),[b,j]=e.useState(null),w=e=>({DocumentVerification:"Document Verification",VehicleListing:"Vehicle Listing",InsuranceVerification:"Insurance Verification",ProfileVerification:"Profile Verification",VehicleApproval:"Vehicle Approval"}[e]||e);return t.jsx(x,{title:l||`Submit ${w(s)} Request`,icon:"FileText",children:t.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{g(!0),j(null),(await u.create({requestType:s,entityId:a,submittedBy:i,reviewNotes:o.trim()||void 0})).data.success?(p.approvalSubmitted(w(s)),r?.()):j("Failed to submit approval request")}catch(t){j(t.response?.data?.error||"Failed to submit approval request")}finally{g(!1)}},className:"space-y-4",children:[c&&t.jsx("p",{className:"text-white/70 text-sm mb-4",children:c}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Additional Notes (Optional)"}),t.jsx("textarea",{value:o,onChange:e=>d(e.target.value),placeholder:"Add any additional information that might help with the approval process...",className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:3})]}),b&&t.jsx("div",{className:"p-3 bg-red-500/20 border border-red-500/30 rounded-lg",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(h,{name:"AlertCircle",size:"sm",className:"text-red-400"}),t.jsx("p",{className:"text-red-400 text-sm",children:b})]})}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{type:"submit",disabled:m,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:m?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),t.jsx("span",{children:"Submitting..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(h,{name:"Send",size:"sm"}),t.jsx("span",{children:"Submit Request"})]})}),n&&t.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 bg-white/10 text-white/70 rounded-lg hover:bg-white/20 transition-colors",children:"Cancel"})]})]})})},F=()=>{const{user:s}=m(),a=d(),[i,r]=e.useState("overview"),[n,l]=e.useState([]),[c,o]=e.useState([]),[u,p]=e.useState(!0),[y,v]=e.useState(!1),[N,k]=e.useState(null);e.useEffect(()=>{A();const e=()=>{A()},t=()=>{A()};return window.addEventListener("bookingCreated",e),window.addEventListener("bookingUpdated",t),()=>{window.removeEventListener("bookingCreated",e),window.removeEventListener("bookingUpdated",t)}},[s?.id]);const A=async()=>{try{if(!s?.id)return void p(!1);const e=await S.getRenterBookings();l(e);const t=e.map(e=>({id:`payment_${e.id}`,amount:e.total_amount,status:"paid"===e.payment_status?"completed":"pending",method:"stripe",bookingId:e.id,createdAt:e.created_at}));o(t)}catch(e){l([]),o([])}finally{p(!1)}},I=n.filter(e=>"confirmed"===e.status),E=c.filter(e=>"completed"===e.status).reduce((e,t)=>e+t.amount,0),U=e=>{k(e),v(!0)};return u?t.jsx(T,{}):t.jsxs("div",{className:"space-y-4 lg:space-y-6",children:[t.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center space-y-4 lg:space-y-0",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl lg:text-2xl font-bold text-white",children:"Renter Dashboard"}),t.jsxs("p",{className:"text-white/70 text-sm lg:text-base",children:["Welcome back, ",s?.firstName,"!"]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-4",children:[t.jsx(g,{userRole:"renter",userId:s?.id||"0",onNotificationClick:e=>{e.actionUrl&&(window.location.href=e.actionUrl)},onMarkAsRead:e=>{},onMarkAllAsRead:()=>{}}),t.jsxs("button",{onClick:()=>a("/search"),className:"flex items-center justify-center px-3 lg:px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm lg:text-base",children:[t.jsx(h,{name:"Search",size:"sm",className:"mr-2"}),t.jsx("span",{className:"hidden sm:inline",children:"Find Vehicles"}),t.jsx("span",{className:"sm:hidden",children:"Search"})]})]})]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:[{id:"overview",label:"Overview",icon:"BarChart"},{id:"account",label:"Account",icon:"User"},{id:"search",label:"Search & Browse",icon:"Search"},{id:"bookings",label:"Bookings",icon:"Calendar"},{id:"payments",label:"Payments",icon:"CreditCard"},{id:"communication",label:"Messages",icon:"MessageCircle"},{id:"analytics",label:"Analytics",icon:"TrendingUp"},{id:"saved",label:"Saved",icon:"Heart"},{id:"calculator",label:"Calculator",icon:"Calculator"},{id:"documents",label:"Documents",icon:"FileText"},{id:"promotions",label:"Promotions",icon:"Gift"},{id:"approvals",label:"Approval Requests",icon:"Clock"}].map(e=>t.jsxs("button",{onClick:()=>r(e.id),className:"flex items-center space-x-1 lg:space-x-2 px-2 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition-all "+(i===e.id?"bg-white/20 text-white":"bg-white/10 text-white/70 hover:bg-white/20"),children:[t.jsx(h,{name:e.icon,size:"sm"}),t.jsx("span",{className:"hidden sm:inline",children:e.label}),t.jsx("span",{className:"sm:hidden",children:e.label.split(" ")[0]})]},e.id))}),t.jsxs("div",{className:"space-y-6",children:["overview"===i&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6",children:[t.jsxs(x,{title:"Active Bookings",subtitle:"Current rentals",icon:"Car",className:"text-center",children:[t.jsx("div",{className:"text-3xl font-bold text-white mb-2",children:I.length}),t.jsx("div",{className:"text-white/70 text-sm",children:"Active now"})]}),t.jsxs(x,{title:"Total Spent",subtitle:"All time spending",icon:"DollarSign",className:"text-center",children:[t.jsxs("div",{className:"text-3xl font-bold text-white mb-2",children:["R",E.toLocaleString()]}),t.jsx("div",{className:"text-white/70 text-sm",children:"Lifetime total"})]}),t.jsxs(x,{title:"Saved Vehicles",subtitle:"Your favorites",icon:"Heart",className:"text-center",children:[t.jsx("div",{className:"text-3xl font-bold text-white mb-2",children:"0"}),t.jsx("div",{className:"text-white/70 text-sm",children:"Saved vehicles"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsx(x,{title:"Recent Bookings",icon:"Calendar",children:t.jsx("div",{className:"space-y-3",children:n.slice(0,3).map(e=>t.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white/5 rounded-lg",children:[t.jsx(C,{src:e.listing?.image_url||"/placeholder-car.jpg",alt:e.listing?.title||"Vehicle",width:48,height:48,className:"w-12 h-12 rounded-lg object-cover"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"text-white font-medium",children:e.listing?.title||"Vehicle"}),t.jsxs("p",{className:"text-white/70 text-sm",children:[new Date(e.start_date).toLocaleDateString()," - ",new Date(e.end_date).toLocaleDateString()]})]}),t.jsx(b,{status:e.status})]},e.id))})}),t.jsx(x,{title:"Quick Actions",icon:"Zap",children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("button",{onClick:()=>a("/search"),className:"w-full p-3 bg-blue-500/20 text-blue-200 rounded-lg hover:bg-blue-500/30 transition-colors text-left",children:[t.jsx(h,{name:"Search",size:"sm",className:"mr-2"}),"Search Vehicles"]}),t.jsxs("button",{onClick:()=>r("calculator"),className:"w-full p-3 bg-green-500/20 text-green-200 rounded-lg hover:bg-green-500/30 transition-colors text-left",children:[t.jsx(h,{name:"Calculator",size:"sm",className:"mr-2"}),"Calculate Rental Cost"]}),t.jsxs("button",{onClick:()=>r("saved"),className:"w-full p-3 bg-purple-500/20 text-purple-200 rounded-lg hover:bg-purple-500/30 transition-colors text-left",children:[t.jsx(h,{name:"Heart",size:"sm",className:"mr-2"}),"View Saved Vehicles"]})]})})]})]}),"account"===i&&t.jsx(q,{}),"search"===i&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(x,{title:"Vehicle Search & Discovery",icon:"Search",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Location"}),t.jsx("input",{type:"text",placeholder:"Enter city or area",className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Vehicle Type"}),t.jsxs("select",{className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"All Types"}),t.jsx("option",{value:"sedan",children:"Sedan"}),t.jsx("option",{value:"suv",children:"SUV"}),t.jsx("option",{value:"hatchback",children:"Hatchback"}),t.jsx("option",{value:"convertible",children:"Convertible"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Start Date"}),t.jsx("input",{type:"date",className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"End Date"}),t.jsx("input",{type:"date",className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),t.jsx("button",{onClick:()=>a("/search"),className:"w-full px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Search Vehicles"})]})}),t.jsx(x,{title:"Browse by Category",icon:"Grid",children:t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:["Economy","Luxury","SUV","Convertible"].map(e=>t.jsxs("button",{onClick:()=>a("/search"),className:"p-4 bg-white/5 rounded-lg hover:bg-white/10 transition-colors text-center",children:[t.jsx(h,{name:"Car",size:"lg",className:"mx-auto mb-2 text-blue-400"}),t.jsx("span",{className:"text-white font-medium",children:e})]},e))})})]}),"bookings"===i&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(j,{userRole:"renter",userId:s?.id||"0",onBookingAction:(e,t,s)=>{A()},onRefresh:A}),n.filter(e=>"pending"===e.status||"confirmed"===e.status).length>0&&t.jsx(x,{title:"Booking Workflow Status",icon:"Clock",children:t.jsx("div",{className:"space-y-4",children:n.filter(e=>"pending"===e.status||"confirmed"===e.status).slice(0,2).map(e=>t.jsxs("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(C,{src:e.listing?.image_url||"/placeholder-car.jpg",alt:e.listing?.title||"Vehicle",width:40,height:40,className:"w-10 h-10 rounded-lg object-cover"}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-medium",children:e.listing?.title||"Vehicle"}),t.jsxs("p",{className:"text-white/70 text-sm",children:[new Date(e.start_date).toLocaleDateString()," - ",new Date(e.end_date).toLocaleDateString()]})]})]}),t.jsx(P,{bookingId:e.id,userRole:"renter",onStepComplete:(e,t)=>{A()},onStepError:(e,t)=>{}})]},e.id))})})]}),"payments"===i&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(x,{title:"Payment Methods",icon:"CreditCard",children:t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:[t.jsx("h4",{className:"text-white font-medium mb-2",children:"Stripe Payment"}),t.jsx("p",{className:"text-white/70 text-sm mb-3",children:"Secure credit card processing"}),t.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Setup Stripe"})]}),t.jsxs("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:[t.jsx("h4",{className:"text-white font-medium mb-2",children:"Payfast"}),t.jsx("p",{className:"text-white/70 text-sm mb-3",children:"South African payment gateway"}),t.jsx("button",{className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:"Setup Payfast"})]})]})})}),t.jsx(x,{title:"Payment History",icon:"CreditCard",children:t.jsx("div",{className:"space-y-3",children:0===c.length?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(h,{name:"CreditCard",size:"lg",className:"text-white/50 mx-auto mb-4"}),t.jsx("p",{className:"text-white/70",children:"No payment history"})]}):c.map(e=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"text-white font-medium",children:["R",e.amount]}),t.jsx("p",{className:"text-white/70 text-sm",children:new Date(e.createdAt).toLocaleDateString()})]}),t.jsxs("div",{className:"text-right",children:[t.jsx(b,{status:e.status}),t.jsx("p",{className:"text-white/70 text-sm capitalize",children:e.method})]})]},e.id))})})]}),"communication"===i&&t.jsx(L,{}),"analytics"===i&&t.jsx(w,{}),"saved"===i&&t.jsx(B,{userId:s?.id||"0"}),"calculator"===i&&t.jsx("div",{className:"space-y-6",children:t.jsx(x,{title:"Rental Cost Calculator",icon:"Calculator",children:t.jsx(z,{basePrice:500,onCalculate:(e,t)=>{}})})}),"documents"===i&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(D,{label:"Upload Document",name:"document",onChange:()=>{}}),t.jsx($,{userId:s?.id||"0"}),t.jsx(x,{title:"Document Verification",icon:"FileText",children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-white/70 text-sm",children:"Submit your documents for verification to access premium features and improve your booking success rate."}),t.jsxs("button",{onClick:()=>U("DocumentVerification"),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center space-x-2",children:[t.jsx(h,{name:"Upload",size:"sm"}),t.jsx("span",{children:"Request Document Verification"})]})]})})]}),"promotions"===i&&t.jsx(R,{userId:s?.id||"0"}),"approvals"===i&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(f,{userRole:"renter"}),t.jsx(x,{title:"Profile Verification",icon:"User",children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-white/70 text-sm",children:"Get your profile verified to build trust with hosts and increase your booking success rate."}),t.jsxs("button",{onClick:()=>U("ProfileVerification"),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors flex items-center space-x-2",children:[t.jsx(h,{name:"UserCheck",size:"sm"}),t.jsx("span",{children:"Request Profile Verification"})]})]})})]})]}),y&&N&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsx("div",{className:"w-full max-w-md",children:t.jsx(V,{requestType:N,entityId:parseInt(s?.id||"0"),submittedBy:"renter",onSuccess:()=>{v(!1),k(null)},onCancel:()=>{v(!1),k(null)}})})})]})},O=({onSubmit:s,onCancel:a,className:i=""})=>{const[r,n]=e.useState(1),[l,c]=e.useState({make:"",model:"",year:(new Date).getFullYear(),type:"car",pricePerDay:0,location:"",description:"",features:[],images:[],documents:{registration:void 0,roadworthy:void 0,insurance:void 0}}),[o,d]=e.useState(!1),[m,x]=e.useState(""),u=(e,t)=>{c(s=>({...s,[e]:t}))},p=(e,t)=>{c(s=>({...s,documents:{...s.documents,[e]:t}}))},g=e=>{switch(e){case 1:return!!(l.make&&l.model&&l.year&&l.type&&l.pricePerDay>0);case 2:return!(!l.location||!l.description);case 3:return l.images.length>0;case 4:return!!(l.documents?.registration&&l.documents?.roadworthy&&l.documents?.insurance);default:return!0}};return t.jsxs("div",{className:`space-y-6 ${i}`,children:[t.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(h,{name:(()=>{switch(r){case 1:return"Car";case 2:return"MapPin";case 3:return"Camera";case 4:return"FileText";default:return"Clipboard"}})(),size:"lg"}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-white",children:(()=>{switch(r){case 1:return"Vehicle Details";case 2:return"Location & Description";case 3:return"Vehicle Photos";case 4:return"Required Documents";default:return"Vehicle Listing"}})()}),t.jsxs("p",{className:"text-white/70 text-sm",children:["Step ",r," of 4 - Submit your vehicle for admin approval"]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-sm text-white/70",children:"Progress"}),t.jsxs("div",{className:"text-lg font-semibold text-white",children:[Math.round(r/4*100),"%"]})]})]}),t.jsx("div",{className:"w-full bg-white/20 rounded-full h-2",children:t.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full transition-all duration-300",style:{width:r/4*100+"%"}})})]}),1===r&&t.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20",children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Vehicle Information"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/90 mb-2",children:"Make *"}),t.jsx("input",{type:"text",value:l.make,onChange:e=>u("make",e.target.value),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/20",placeholder:"Toyota",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/90 mb-2",children:"Model *"}),t.jsx("input",{type:"text",value:l.model,onChange:e=>u("model",e.target.value),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/20",placeholder:"Corolla",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/90 mb-2",children:"Year *"}),t.jsx("input",{type:"number",value:l.year,onChange:e=>u("year",parseInt(e.target.value)),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/20",min:"1990",max:(new Date).getFullYear()+1,required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/90 mb-2",children:"Price per Day (R) *"}),t.jsx("input",{type:"number",value:l.pricePerDay,onChange:e=>u("pricePerDay",parseFloat(e.target.value)),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/20",min:"0",step:"0.01",required:!0})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-white/90 mb-2",children:"Vehicle Type *"}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2",children:[{value:"car",label:"Car",icon:"Car"},{value:"suv",label:"SUV",icon:"Truck"},{value:"bakkie",label:"Bakkie",icon:"Truck"},{value:"van",label:"Van",icon:"Truck"},{value:"motorcycle",label:"Motorcycle",icon:"Bike"}].map(e=>t.jsxs("button",{onClick:()=>u("type",e.value),className:"p-3 rounded-lg text-sm font-medium transition-all "+(l.type===e.value?"bg-blue-500/20 text-blue-300 border border-blue-500/30":"bg-white/10 text-white/70 border border-white/20 hover:bg-white/20"),children:[t.jsx(h,{name:e.icon,size:"sm",className:"mr-2"}),e.label]},e.value))})]})]})]}),2===r&&t.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20",children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Location & Description"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/90 mb-2",children:"Location *"}),t.jsx("input",{type:"text",value:l.location,onChange:e=>u("location",e.target.value),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/20",placeholder:"Cape Town, Western Cape",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/90 mb-2",children:"Description *"}),t.jsx("textarea",{value:l.description,onChange:e=>u("description",e.target.value),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/20",rows:4,placeholder:"Describe your vehicle, its condition, and any special features...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/90 mb-2",children:"Vehicle Features"}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[{id:"aircon",name:"Air Conditioning",category:"comfort"},{id:"bluetooth",name:"Bluetooth",category:"entertainment"},{id:"gps",name:"GPS Navigation",category:"convenience"},{id:"usb",name:"USB Charging",category:"convenience"},{id:"backup_camera",name:"Backup Camera",category:"safety"},{id:"parking_sensors",name:"Parking Sensors",category:"safety"},{id:"cruise_control",name:"Cruise Control",category:"comfort"},{id:"leather_seats",name:"Leather Seats",category:"comfort"}].map(e=>t.jsxs("label",{className:"flex items-center space-x-2 p-2 bg-white/5 rounded-lg hover:bg-white/10 transition-colors cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:l.features.some(t=>t.id===e.id),onChange:()=>(e=>{c(t=>({...t,features:t.features.some(t=>t.id===e.id)?t.features.filter(t=>t.id!==e.id):[...t.features,e]}))})(e),className:"w-4 h-4 text-blue-600 bg-white/10 border-white/20 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-white/90",children:e.name})]},e.id))})]})]})]}),3===r&&t.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20",children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Vehicle Photos"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/90 mb-2",children:"Upload Vehicle Photos *"}),t.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:e=>(e=>{if(e){const t=Array.from(e);c(e=>({...e,images:[...e.images,...t]}))}})(e.target.files),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-blue-500/20 file:text-blue-300 hover:file:bg-blue-500/30"}),t.jsx("p",{className:"text-xs text-white/60 mt-1",children:"Upload multiple photos showing exterior, interior, and license disc"})]}),l.images.length>0&&t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm text-white/70 mb-2",children:["Uploaded Photos (",l.images.length,"):"]}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:l.images.map((e,s)=>t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:URL.createObjectURL(e),alt:`Vehicle photo ${s+1}`,className:"w-full h-20 object-cover rounded-lg"}),t.jsx("button",{onClick:()=>{const e=l.images.filter((e,t)=>t!==s);c(t=>({...t,images:e}))},className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600",children:"×"})]},s))})]})]})]}),4===r&&t.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20",children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Required Documents"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsx(D,{label:"Vehicle Registration",name:"registration",value:l.documents?.registration,onChange:e=>p("registration",e),required:!0,description:"Official vehicle registration document"}),t.jsx(D,{label:"Roadworthy Certificate",name:"roadworthy",value:l.documents?.roadworthy,onChange:e=>p("roadworthy",e),required:!0,description:"Valid roadworthy certificate"}),t.jsx(D,{label:"Insurance Certificate",name:"insurance",value:l.documents?.insurance,onChange:e=>p("insurance",e),required:!0,description:"Comprehensive insurance certificate"})]})]}),m&&t.jsx("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-3",children:t.jsx("p",{className:"text-red-300 text-sm",children:m})}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("button",{onClick:()=>{n(e=>Math.max(e-1,1))},disabled:1===r,className:"px-6 py-2 rounded-lg font-medium transition-all "+(1===r?"bg-gray-500/20 text-gray-400 cursor-not-allowed":"bg-white/10 text-white hover:bg-white/20"),children:"Previous"}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:a,className:"px-6 py-2 bg-gray-500/20 text-gray-300 rounded-lg font-medium hover:bg-gray-500/30 transition-all",children:"Cancel"}),r<4?t.jsx("button",{onClick:()=>{g(r)?n(e=>Math.min(e+1,4)):x("Please fill in all required fields before proceeding.")},className:"px-6 py-2 bg-blue-500/20 text-blue-300 rounded-lg font-medium hover:bg-blue-500/30 transition-all",children:"Next"}):t.jsx("button",{onClick:async()=>{if(g(4)){d(!0),x("");try{await s(l)}catch(e){x("Failed to submit vehicle listing. Please try again.")}finally{d(!1)}}else x("Please complete all required fields and upload all documents.")},disabled:o,className:"px-6 py-2 rounded-lg font-medium transition-all "+(o?"bg-gray-500/20 text-gray-400 cursor-not-allowed":"bg-green-500/20 text-green-300 hover:bg-green-500/30"),children:o?"Submitting...":"Submit for Admin Approval"})]})]})]})},M=({hostId:s,className:a=""})=>{const[i,r]=e.useState([]),[n,l]=e.useState(!0),[c,o]=e.useState(!1),[d,m]=e.useState([]);e.useEffect(()=>{x()},[s]);const x=async()=>{try{const e=localStorage.getItem("authToken"),t=await fetch(`/api/hosts/${s}/fleet`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(t.ok){const e=await t.json();r(e.vehicles||[])}}catch(e){r([{id:"1",hostId:s,make:"Toyota",model:"Hilux",year:2022,type:"bakkie",pricePerDay:250,dailyRate:250,location:"Cape Town",images:["https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?w=400"],features:[],status:"approved",approvalStatus:"approved",description:"Perfect for your South African adventure!",fuelType:"petrol",transmission:"manual",seats:5,doors:4,isAvailable:!0,rating:4.8,reviewCount:24,createdAt:new Date,updatedAt:new Date},{id:"2",hostId:s,make:"BMW",model:"X3",year:2021,type:"suv",pricePerDay:400,dailyRate:400,location:"Johannesburg",images:["https://images.unsplash.com/photo-1549317336-206569e8475c?w=400"],features:[],status:"pending",approvalStatus:"pending",description:"Luxury SUV for city and country driving.",fuelType:"petrol",transmission:"automatic",seats:5,doors:4,isAvailable:!0,rating:4.9,reviewCount:12,createdAt:new Date,updatedAt:new Date}])}finally{l(!1)}},u=async e=>{if(0!==d.length)try{const t=localStorage.getItem("authToken");await fetch(`/api/hosts/${s}/fleet/bulk-action`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({vehicleIds:d,action:e})}),r(t=>{switch(e){case"activate":return t.map(e=>d.includes(e.id)?{...e,isAvailable:!0}:e);case"deactivate":return t.map(e=>d.includes(e.id)?{...e,isAvailable:!1}:e);case"delete":return t.filter(e=>!d.includes(e.id));default:return t}}),m([])}catch(t){}},p=e=>{switch(e){case"approved":return"text-green-400 bg-green-500/20 border-green-500/30";case"pending":return"text-yellow-400 bg-yellow-500/20 border-yellow-500/30";case"rejected":return"text-red-400 bg-red-500/20 border-red-500/30";default:return"text-gray-400 bg-gray-500/20 border-gray-500/30"}},g=e=>{switch(e){case"approved":return"CheckCircle";case"pending":return"Clock";case"rejected":return"XCircle";default:return"FileText"}};return n?t.jsx("div",{className:`space-y-4 ${a}`,children:[...Array(3)].map((e,s)=>t.jsx("div",{className:"animate-pulse",children:t.jsx("div",{className:"h-24 bg-white/10 rounded-lg"})},s))}):t.jsxs("div",{className:`space-y-4 ${a}`,children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:"Fleet Management"}),t.jsxs("p",{className:"text-white/70 text-sm",children:[i.length," vehicles in your fleet"]})]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsxs("button",{onClick:()=>o(!c),className:"px-3 py-1 bg-blue-500/20 text-blue-300 rounded-lg text-sm hover:bg-blue-500/30 transition-colors flex items-center space-x-1",children:[t.jsx(h,{name:"Upload",size:"sm"}),t.jsx("span",{children:"Bulk Upload"})]}),t.jsx("button",{className:"px-3 py-1 bg-green-500/20 text-green-300 rounded-lg text-sm hover:bg-green-500/30 transition-colors",children:"+ Add Vehicle"})]})]}),d.length>0&&t.jsx("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("span",{className:"text-blue-300 text-sm",children:[d.length," vehicle(s) selected"]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:()=>u("activate"),className:"px-2 py-1 bg-green-500/20 text-green-300 rounded text-xs hover:bg-green-500/30 transition-colors",children:"Activate"}),t.jsx("button",{onClick:()=>u("deactivate"),className:"px-2 py-1 bg-yellow-500/20 text-yellow-300 rounded text-xs hover:bg-yellow-500/30 transition-colors",children:"Deactivate"}),t.jsx("button",{onClick:()=>u("delete"),className:"px-2 py-1 bg-red-500/20 text-red-300 rounded text-xs hover:bg-red-500/30 transition-colors",children:"Delete"})]})]})}),t.jsx("div",{className:"space-y-3",children:i.map(e=>t.jsx("div",{className:`p-4 rounded-lg border ${d.includes(e.id)?"bg-blue-500/20 border-blue-500/30":"bg-white/10 border-white/20"} hover:bg-white/20 transition-all duration-300`,children:t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("input",{type:"checkbox",checked:d.includes(e.id),onChange:()=>{return t=e.id,void m(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"w-4 h-4 text-blue-600 bg-white/10 border-white/20 rounded focus:ring-blue-500"}),t.jsx("img",{src:e.images[0],alt:`${e.make} ${e.model}`,className:"w-16 h-16 object-cover rounded-lg"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("h4",{className:"text-lg font-semibold text-white",children:[e.year," ",e.make," ",e.model]}),t.jsxs("div",{className:`px-2 py-1 rounded-full text-xs border ${p(e.approvalStatus)} flex items-center space-x-1`,children:[t.jsx(h,{name:g(e.approvalStatus),size:"sm"}),t.jsx("span",{children:e.approvalStatus})]})]}),t.jsxs("div",{className:"flex items-center space-x-4 text-sm text-white/70",children:[t.jsxs("span",{className:"flex items-center space-x-1",children:[t.jsx(h,{name:"MapPin",size:"sm"}),t.jsx("span",{children:e.location})]}),t.jsxs("span",{className:"flex items-center space-x-1",children:[t.jsx(h,{name:"DollarSign",size:"sm"}),t.jsxs("span",{children:["R",e.pricePerDay,"/day"]})]}),t.jsxs("span",{className:"flex items-center space-x-1",children:[t.jsx(h,{name:"Star",size:"sm"}),t.jsxs("span",{children:[e.rating," (",e.reviewCount,")"]})]}),t.jsx("span",{className:e.isAvailable?"text-green-400":"text-red-400",children:e.isAvailable?"Available":"Unavailable"})]})]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{className:"px-3 py-1 bg-white/10 text-white rounded-lg text-sm hover:bg-white/20 transition-colors",children:"Edit"}),t.jsx("button",{className:"px-3 py-1 bg-white/10 text-white rounded-lg text-sm hover:bg-white/20 transition-colors",children:"View"})]})]})},e.id))}),0===i.length&&t.jsxs("div",{className:"text-center py-8",children:[t.jsx("div",{className:"mb-4",children:t.jsx(h,{name:"Car",size:"lg",className:"text-white/50 mx-auto"})}),t.jsx("p",{className:"text-white/70",children:"No vehicles in your fleet yet"}),t.jsx("p",{className:"text-white/50 text-sm",children:"Add your first vehicle to start earning!"})]})]})},_=({vehicleId:s,basePrice:a,onPriceUpdate:i,className:r=""})=>{const[n,l]=e.useState([]),[c,o]=e.useState(a),[d,m]=e.useState(!0);e.useEffect(()=>{x()},[s]),e.useEffect(()=>{u()},[n,a]);const x=async()=>{try{const e=localStorage.getItem("authToken"),t=await fetch(`/api/listings/${s}/pricing-rules`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(t.ok){const e=await t.json();l(e.rules||[])}}catch(e){l([{id:"1",name:"Weekend Premium",type:"time",conditions:{dayOfWeek:[0,6]},multiplier:1.5,isActive:!0},{id:"2",name:"Peak Hours",type:"time",conditions:{timeRange:{start:"07:00",end:"09:00"}},multiplier:1.3,isActive:!0},{id:"3",name:"High Demand",type:"demand",conditions:{demandLevel:"high"},multiplier:1.4,isActive:!0}])}finally{m(!1)}},u=()=>{let e=a;const t=new Date,s=t.getDay(),r=t.toTimeString().slice(0,5),l=n.filter(e=>{if(!e.isActive)return!1;switch(e.type){case"time":if(e.conditions.dayOfWeek?.includes(s))return!0;if(e.conditions.timeRange){const{start:t,end:s}=e.conditions.timeRange;return r>=t&&r<=s}return!1;case"demand":return"high"===e.conditions.demandLevel;default:return!1}}).reduce((e,t)=>Math.max(e,t.multiplier),1);e=Math.round(a*l),o(e),i(e)},p=e=>{l(t=>t.map(t=>t.id===e?{...t,isActive:!t.isActive}:t))};return d?t.jsx("div",{className:`space-y-4 ${r}`,children:t.jsxs("div",{className:"animate-pulse",children:[t.jsx("div",{className:"h-8 bg-white/10 rounded w-1/3 mb-4"}),t.jsx("div",{className:"h-32 bg-white/10 rounded-lg"})]})}):t.jsxs("div",{className:`space-y-4 ${r}`,children:[t.jsx("div",{className:"bg-white/10 rounded-lg p-4 border border-white/20",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:"Current Price"}),t.jsx("p",{className:"text-white/70 text-sm",children:"Based on active pricing rules"})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"text-2xl font-bold text-green-400",children:["R",c]}),t.jsx("div",{className:"text-sm text-white/70",children:c>a?`+${Math.round((c-a)/a*100)}%`:"Base price"})]})]})}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-medium text-white/90 mb-3",children:"Active Pricing Rules"}),t.jsx("div",{className:"space-y-2",children:n.filter(e=>e.isActive).map(e=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-500/20 border border-green-500/30 rounded-lg",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(h,{name:"Zap",size:"sm"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-white",children:e.name}),t.jsxs("p",{className:"text-xs text-white/70",children:["time"===e.type&&"Time-based","demand"===e.type&&"Demand-based","seasonal"===e.type&&"Seasonal","event"===e.type&&"Event-based"]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("span",{className:"text-sm text-green-300",children:["+",Math.round(100*(e.multiplier-1)),"%"]}),t.jsx("button",{onClick:()=>p(e.id),className:"text-red-400 hover:text-red-300 transition-colors",children:"✕"})]})]},e.id))})]}),n.filter(e=>!e.isActive).length>0&&t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-medium text-white/90 mb-3",children:"Inactive Rules"}),t.jsx("div",{className:"space-y-2",children:n.filter(e=>!e.isActive).map(e=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 border border-white/10 rounded-lg",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(h,{name:"Pause",size:"sm"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-white/70",children:e.name}),t.jsxs("p",{className:"text-xs text-white/50",children:["time"===e.type&&"Time-based","demand"===e.type&&"Demand-based","seasonal"===e.type&&"Seasonal","event"===e.type&&"Event-based"]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>p(e.id),className:"text-green-400 hover:text-green-300 transition-colors",children:t.jsx(h,{name:"Play",size:"sm"})}),t.jsx("button",{onClick:()=>{return t=e.id,void l(e=>e.filter(e=>e.id!==t));var t},className:"text-red-400 hover:text-red-300 transition-colors",children:t.jsx(h,{name:"Trash",size:"sm"})})]})]},e.id))})]}),t.jsx("button",{className:"w-full p-3 border-2 border-dashed border-white/30 rounded-lg text-white/70 hover:border-white/50 hover:text-white transition-colors",children:"+ Add New Pricing Rule"})]})},H=({bookingId:s,amount:a,onPaymentSuccess:i,onPaymentError:r})=>{const[n,l]=e.useState("stripe"),[c,o]=e.useState(!1),d=Math.round(.05*a),m=a+d;return t.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20",children:[t.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Payment Details"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-white/5 rounded-lg p-4",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"text-white/70",children:"Base Amount"}),t.jsxs("span",{className:"text-white",children:["R",a.toLocaleString()]})]}),t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"text-white/70",children:"Service Fee (5%)"}),t.jsxs("span",{className:"text-white",children:["R",d.toLocaleString()]})]}),t.jsx("div",{className:"border-t border-white/20 pt-2",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-white font-semibold",children:"Total"}),t.jsxs("span",{className:"text-white font-bold text-lg",children:["R",m.toLocaleString()]})]})})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("label",{className:"text-white font-medium",children:"Payment Method"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsx("button",{onClick:()=>l("stripe"),className:"p-3 rounded-lg border-2 transition-all "+("stripe"===n?"border-blue-400 bg-blue-500/20":"border-white/20 bg-white/5 hover:bg-white/10"),children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(h,{name:"CreditCard",size:"sm"}),t.jsx("span",{className:"text-white text-sm",children:"Stripe"})]})}),t.jsx("button",{onClick:()=>l("payfast"),className:"p-3 rounded-lg border-2 transition-all "+("payfast"===n?"border-blue-400 bg-blue-500/20":"border-white/20 bg-white/5 hover:bg-white/10"),children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(h,{name:"CreditCard",size:"sm"}),t.jsx("span",{className:"text-white text-sm",children:"Payfast"})]})})]})]}),t.jsx("button",{onClick:"stripe"===n?async()=>{o(!0);try{const e=await fetch("/api/payments/stripe/create-intent",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify({bookingId:s,amount:a,currency:"ZAR",paymentMethod:"stripe"})}),t=await e.json();t.success?setTimeout(()=>{i(t.paymentIntent),o(!1)},2e3):(r(t.error||"Payment failed"),o(!1))}catch(e){r("Network error"),o(!1)}}:async()=>{o(!0);try{const e=await fetch("/api/payments/payfast/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify({bookingId:s,amount:a,currency:"ZAR",paymentMethod:"payfast"})}),t=await e.json();t.success?window.location.href=`${t.payfastUrl}?${new URLSearchParams(t.paymentData).toString()}`:(r(t.error||"Payment failed"),o(!1))}catch(e){r("Network error"),o(!1)}},disabled:c,className:"w-full py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg font-medium hover:from-blue-600 hover:to-purple-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:c?t.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),t.jsx("span",{children:"Processing..."})]}):`Pay R${m.toLocaleString()} with ${"stripe"===n?"Stripe":"Payfast"}`}),t.jsx("div",{className:"bg-green-500/10 border border-green-400/30 rounded-lg p-3",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(h,{name:"Shield",size:"sm",className:"text-green-400"}),t.jsx("span",{className:"text-green-200 text-sm",children:"Your payment is secure and encrypted"})]})})]})]})},J=()=>{const{user:s}=m(),{showToast:a}=y(),[i,r]=e.useState("overview"),[n,l]=e.useState([]),[c,o]=e.useState([]),[d,u]=e.useState({totalEarnings:0,monthlyEarnings:0,pendingPayouts:0,completedBookings:0}),[p,N]=e.useState([]),[k,S]=e.useState([]),[C,A]=e.useState([]),[T,D]=e.useState(null),[B,$]=e.useState(null),[R,z]=e.useState(!0),[I,E]=e.useState(null),[U,F]=e.useState(!1),[J,W]=e.useState(null),[Z,G]=e.useState(null);e.useEffect(()=>{X(),Y()},[]);const Y=async()=>{if(s?.id)try{const e=await fetch(`/api/listings/host/${s.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(e.ok){const t=await e.json();if(t.success){const e=t.vehicles;l(e),N(e.filter(e=>"pending"===e.status)),S(e.filter(e=>"approved"===e.status)),A(e.filter(e=>"rejected"===e.status))}}}catch(e){}},X=async()=>{try{if(z(!0),a("Loading your dashboard data...","info"),!s?.id)return void z(!1);const e=await fetch("/api/listings/host",{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`,"Content-Type":"application/json"}});if(e.ok){const t=await e.json();l(t.data||[])}const t=await fetch("/api/bookings/host",{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`,"Content-Type":"application/json"}});if(t.ok){const e=await t.json();o(e.data||[])}const i=await fetch("/api/host/earnings",{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`,"Content-Type":"application/json"}});if(i.ok){const e=await i.json();u(e)}const r=await fetch("/api/host/analytics",{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`,"Content-Type":"application/json"}});if(r.ok){const e=await r.json();D(e)}const n=await fetch("/api/host/financial",{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`,"Content-Type":"application/json"}});if(n.ok){const e=await n.json();$(e)}}catch(e){a("Failed to load dashboard data. Please try again.","error"),l([]),o([]),u({totalEarnings:0,monthlyEarnings:0,pendingPayouts:0,completedBookings:0}),D(null),$(null)}finally{z(!1)}},K=c.filter(e=>"pending"===e.status),Q=c.filter(e=>"confirmed"===e.status),ee=(e,t)=>{W(e),G(null),F(!0)};return R?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"space-y-4 lg:space-y-6",children:[t.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center space-y-4 lg:space-y-0",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl lg:text-2xl font-bold text-white",children:"Host Dashboard"}),t.jsx("p",{className:"text-white/70 text-sm lg:text-base",children:"Manage your vehicle rental business"})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-4",children:[t.jsx(g,{userRole:"host",userId:s?.id||"0",onNotificationClick:e=>{e.actionUrl&&(window.location.href=e.actionUrl)},onMarkAsRead:e=>{},onMarkAllAsRead:()=>{}}),t.jsxs("button",{onClick:()=>r("vehicles"),className:"flex items-center justify-center px-3 lg:px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm lg:text-base",children:[t.jsx(h,{name:"Plus",size:"sm",className:"mr-2"}),t.jsx("span",{className:"hidden sm:inline",children:"Add Vehicle"}),t.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:[{id:"overview",label:"Overview",icon:"BarChart"},{id:"account",label:"Account",icon:"User"},{id:"vehicles",label:"Vehicle Management",icon:"Car"},{id:"bookings",label:"Booking Management",icon:"Calendar"},{id:"financial",label:"Financial",icon:"DollarSign"},{id:"communication",label:"Messages",icon:"MessageCircle"},{id:"analytics",label:"Analytics",icon:"TrendingUp"},{id:"fleet",label:"Fleet Tools",icon:"Settings"},{id:"pricing",label:"Dynamic Pricing",icon:"TrendingUp"},{id:"approvals",label:"Approval Requests",icon:"Clock"}].map(e=>t.jsxs("button",{onClick:()=>r(e.id),className:"flex items-center space-x-1 lg:space-x-2 px-2 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition-all "+(i===e.id?"bg-white/20 text-white":"bg-white/10 text-white/70 hover:bg-white/20"),children:[t.jsx(h,{name:e.icon,size:"sm"}),t.jsx("span",{className:"hidden sm:inline",children:e.label}),t.jsx("span",{className:"sm:hidden",children:e.label.split(" ")[0]})]},e.id))}),t.jsxs("div",{className:"space-y-6",children:["overview"===i&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t.jsxs(x,{title:"Total Earnings",subtitle:"All time",icon:"DollarSign",className:"text-center",children:[t.jsxs("div",{className:"text-3xl font-bold text-white mb-2",children:["R",d.totalEarnings.toLocaleString()]}),t.jsx("div",{className:"text-white/70 text-sm",children:"Lifetime earnings"})]}),t.jsxs(x,{title:"Active Vehicles",subtitle:"Listed vehicles",icon:"Car",className:"text-center",children:[t.jsx("div",{className:"text-3xl font-bold text-white mb-2",children:k.length}),t.jsx("div",{className:"text-white/70 text-sm",children:"Available for rent"})]}),t.jsxs(x,{title:"Pending Bookings",subtitle:"Awaiting approval",icon:"Clock",className:"text-center",children:[t.jsx("div",{className:"text-3xl font-bold text-white mb-2",children:K.length}),t.jsx("div",{className:"text-white/70 text-sm",children:"Need your attention"})]}),t.jsxs(x,{title:"Active Bookings",subtitle:"Current rentals",icon:"Calendar",className:"text-center",children:[t.jsx("div",{className:"text-3xl font-bold text-white mb-2",children:Q.length}),t.jsx("div",{className:"text-white/70 text-sm",children:"Currently rented"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx(x,{title:"Recent Bookings",icon:"Calendar",children:t.jsx("div",{className:"space-y-3",children:c.slice(0,3).map(e=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg",children:[t.jsxs("div",{children:[t.jsxs("h4",{className:"text-white font-medium",children:[e.renter.firstName," ",e.renter.lastName]}),t.jsxs("p",{className:"text-white/70 text-sm",children:[new Date(e.startDate).toLocaleDateString()," - ",new Date(e.endDate).toLocaleDateString()]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx(b,{status:e.status}),t.jsxs("p",{className:"text-white font-semibold mt-1",children:["R",e.totalPrice]})]})]},e.id))})}),t.jsx(x,{title:"Recent Reviews",icon:"Star",children:t.jsx("div",{className:"space-y-3",children:T?.customerFeedback?.recentReviews?.length>0?T.customerFeedback.recentReviews.slice(0,3).map((e,s)=>t.jsxs("div",{className:"p-3 bg-white/5 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"flex items-center space-x-1",children:[...Array(5)].map((s,a)=>t.jsx(h,{name:"Star",size:"sm",className:a<e.rating?"text-yellow-400":"text-gray-400"},a))}),t.jsx("span",{className:"text-white/70 text-sm",children:e.date})]}),t.jsx("p",{className:"text-white/80 text-sm",children:e.comment})]},s)):t.jsxs("div",{className:"text-center py-8",children:[t.jsx(h,{name:"Star",size:"lg",className:"text-white/30 mx-auto mb-2"}),t.jsx("p",{className:"text-white/50",children:"No reviews yet"})]})})}),t.jsx(x,{title:"Quick Actions",icon:"Zap",children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("button",{onClick:()=>r("vehicles"),className:"w-full p-3 bg-green-500/20 text-green-200 rounded-lg hover:bg-green-500/30 transition-colors text-left",children:[t.jsx(h,{name:"Car",size:"sm",className:"mr-2"}),"Manage Vehicles"]}),t.jsxs("button",{onClick:()=>r("bookings"),className:"w-full p-3 bg-blue-500/20 text-blue-200 rounded-lg hover:bg-blue-500/30 transition-colors text-left",children:[t.jsx(h,{name:"Calendar",size:"sm",className:"mr-2"}),"Review Bookings"]}),t.jsxs("button",{onClick:()=>r("financial"),className:"w-full p-3 bg-purple-500/20 text-purple-200 rounded-lg hover:bg-purple-500/30 transition-colors text-left",children:[t.jsx(h,{name:"DollarSign",size:"sm",className:"mr-2"}),"View Earnings"]})]})})]})]}),"account"===i&&t.jsx(q,{}),"vehicles"===i&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(O,{onSubmit:async e=>{try{const s=new FormData;s.append("title",`${e.make} ${e.model} ${e.year}`),s.append("description",e.description),s.append("make",e.make),s.append("model",e.model),s.append("year",e.year.toString()),s.append("vehicle_type",e.type),s.append("category","economy"),s.append("price_per_day",e.pricePerDay.toString());const a={city:e.location.split(",")[0]?.trim()||e.location,province:e.location.split(",")[1]?.trim()||"Western Cape"};s.append("location",JSON.stringify(a)),e.features&&e.features.length>0&&s.append("features",JSON.stringify(e.features.map(e=>e.name))),e.images&&e.images.length>0&&e.images.forEach(e=>{s.append("images",e)});const i=await fetch("/api/listings",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:s});if(i.ok){const e=await i.json();e.success?(alert("Vehicle listing submitted successfully! Awaiting admin approval."),Y()):alert("Failed to submit vehicle listing: "+(e.error||"Unknown error"))}else{const e=await i.text();let s="Server error";try{s=JSON.parse(e).error||s}catch(t){s=e||s}alert("Failed to submit vehicle listing: "+s)}}catch(s){alert("Failed to submit vehicle listing. Please try again.")}},onCancel:()=>{}}),p.length>0&&t.jsx(x,{title:"Pending Approval",icon:"Clock",className:"border-yellow-500/20",children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-yellow-200 text-sm",children:"Your listings are awaiting admin approval. You'll be notified once they're reviewed."}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.map(e=>t.jsx("div",{className:"p-4 bg-yellow-500/10 rounded-lg border border-yellow-500/20",children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-semibold",children:e.title}),t.jsxs("p",{className:"text-white/70 text-sm",children:[e.make," ",e.model," (",e.year,")"]})]}),t.jsx("span",{className:"px-2 py-1 bg-yellow-500/20 text-yellow-200 rounded text-xs",children:"Pending"})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("span",{className:"text-white/70",children:["R",e.price_per_day,"/day"]}),t.jsx("span",{className:"text-white/70",children:e.location?.city})]}),t.jsx("p",{className:"text-yellow-200 text-sm",children:"Your listing is awaiting admin approval."})]})},e.id))})]})}),k.length>0&&t.jsx(x,{title:"Approved Vehicles",icon:"CheckCircle",className:"border-green-500/20",children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-green-200 text-sm",children:"These vehicles are live and visible to renters."}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(e=>t.jsx("div",{className:"p-4 bg-green-500/10 rounded-lg border border-green-500/20",children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-semibold",children:e.title}),t.jsxs("p",{className:"text-white/70 text-sm",children:[e.make," ",e.model," (",e.year,")"]})]}),t.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-200 rounded text-xs",children:"Approved"})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("span",{className:"text-white/70",children:["R",e.price_per_day,"/day"]}),t.jsxs("span",{className:"text-white/70",children:[e.total_bookings," bookings"]})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("span",{className:"text-white/70",children:["R",e.total_earnings," earned"]}),t.jsx("span",{className:"text-white/70",children:e.location?.city})]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:async()=>{E(`edit-${e.id}`);try{await new Promise(e=>setTimeout(e,1500)),a("Vehicle edit form opened successfully!","success")}catch(t){a("Failed to open vehicle editor","error")}finally{E(null)}},disabled:I===`edit-${e.id}`,className:"flex-1 px-3 py-1 bg-blue-500/20 text-blue-200 rounded text-sm hover:bg-blue-500/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:I===`edit-${e.id}`?t.jsx(v,{size:"sm",text:""}):"Edit"}),t.jsx("button",{onClick:async()=>{if(confirm("Are you sure you want to remove this vehicle? This action cannot be undone.")){E(`remove-${e.id}`);try{await new Promise(e=>setTimeout(e,2e3)),a("Vehicle removed successfully!","success")}catch(t){a("Failed to remove vehicle","error")}finally{E(null)}}},disabled:I===`remove-${e.id}`,className:"flex-1 px-3 py-1 bg-red-500/20 text-red-200 rounded text-sm hover:bg-red-500/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:I===`remove-${e.id}`?t.jsx(v,{size:"sm",text:""}):"Remove"})]})]})},e.id))})]})}),C.length>0&&t.jsx(x,{title:"Rejected Vehicles",icon:"XCircle",className:"border-red-500/20",children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-red-200 text-sm",children:"These vehicles were rejected. Please review the feedback and resubmit if needed."}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:C.map(e=>t.jsx("div",{className:"p-4 bg-red-500/10 rounded-lg border border-red-500/20",children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-semibold",children:e.title}),t.jsxs("p",{className:"text-white/70 text-sm",children:[e.make," ",e.model," (",e.year,")"]})]}),t.jsx("span",{className:"px-2 py-1 bg-red-500/20 text-red-200 rounded text-xs",children:"Rejected"})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("span",{className:"text-white/70",children:["R",e.price_per_day,"/day"]}),t.jsx("span",{className:"text-white/70",children:e.location?.city})]}),e.rejection_reason&&t.jsxs("div",{className:"p-3 bg-red-500/20 rounded border border-red-500/30",children:[t.jsx("p",{className:"text-red-200 text-sm font-medium mb-1",children:"Rejection Reason:"}),t.jsx("p",{className:"text-red-100 text-sm",children:e.rejection_reason})]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:()=>{alert("Edit and resubmit functionality will be implemented")},className:"flex-1 px-3 py-1 bg-blue-500/20 text-blue-200 rounded text-sm hover:bg-blue-500/30 transition-colors",children:"Edit & Resubmit"}),t.jsx("button",{onClick:()=>{confirm("Are you sure you want to remove this rejected vehicle?")&&alert("Remove rejected vehicle functionality will be implemented")},className:"flex-1 px-3 py-1 bg-red-500/20 text-red-200 rounded text-sm hover:bg-red-500/30 transition-colors",children:"Remove"})]})]})},e.id))})]})}),0===n.length&&t.jsx(x,{title:"Your Vehicles",icon:"Car",children:t.jsxs("div",{className:"text-center py-8",children:[t.jsx(h,{name:"Car",size:"lg",className:"text-white/50 mx-auto mb-4"}),t.jsx("p",{className:"text-white/70 mb-4",children:"No vehicles listed yet"}),t.jsx("p",{className:"text-white/50 text-sm mb-6",children:"List your first vehicle to start earning from rentals"})]})}),t.jsx(M,{hostId:s?.id||"0"})]}),"bookings"===i&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(j,{userRole:"host",userId:s?.id||"0",onBookingAction:(e,t,s)=>{X()},onRefresh:X}),K.length>0&&t.jsx(x,{title:"Pending Booking Workflows",icon:"Clock",children:t.jsx("div",{className:"space-y-4",children:K.slice(0,2).map(e=>t.jsxs("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:t.jsxs("span",{className:"text-white font-semibold text-sm",children:[e.renter.firstName[0],e.renter.lastName[0]]})}),t.jsxs("div",{children:[t.jsxs("h4",{className:"text-white font-medium",children:[e.renter.firstName," ",e.renter.lastName]}),t.jsxs("p",{className:"text-white/70 text-sm",children:[new Date(e.startDate).toLocaleDateString()," - ",new Date(e.endDate).toLocaleDateString()]})]})]}),t.jsx(P,{bookingId:e.id,userRole:"host",onStepComplete:(e,t)=>{X()},onStepError:(e,t)=>{}})]},e.id))})})]}),"financial"===i&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(H,{bookingId:0,amount:0,onPaymentSuccess:()=>{},onPaymentError:()=>{}}),t.jsx(x,{title:"Earnings Overview",icon:"DollarSign",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"text-2xl font-bold text-white mb-1",children:["R",d.totalEarnings.toLocaleString()]}),t.jsx("div",{className:"text-white/70 text-sm",children:"Total Earnings"}),t.jsx("div",{className:"text-green-400 text-sm mt-1",children:"+12% from last month"})]}),t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"text-2xl font-bold text-white mb-1",children:["R",d.monthlyEarnings.toLocaleString()]}),t.jsx("div",{className:"text-white/70 text-sm",children:"This Month"}),t.jsxs("div",{className:"text-blue-400 text-sm mt-1",children:["Next payout: ",B?.upcomingPayouts?.[0]?.date||"N/A"]})]}),t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"text-2xl font-bold text-white mb-1",children:["R",d.pendingPayouts.toLocaleString()]}),t.jsx("div",{className:"text-white/70 text-sm",children:"Pending Payouts"}),t.jsx("div",{className:"text-yellow-400 text-sm mt-1",children:"Available for withdrawal"})]})]})}),t.jsx(x,{title:"Transaction History",icon:"CreditCard",children:t.jsx("div",{className:"space-y-3",children:B?.transactionHistory?.length>0?B.transactionHistory.slice(0,5).map(e=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-2 h-2 rounded-full "+("completed"===e.status?"bg-green-400":"pending"===e.status?"bg-yellow-400":"bg-red-400")}),t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium capitalize",children:e.type}),t.jsx("p",{className:"text-white/70 text-sm",children:e.date})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("p",{className:"text-white font-semibold",children:["R",e.amount.toLocaleString()]}),t.jsx("p",{className:"text-white/70 text-sm capitalize",children:e.status})]})]},e.id)):t.jsxs("div",{className:"text-center py-8",children:[t.jsx(h,{name:"CreditCard",size:"lg",className:"text-white/30 mx-auto mb-2"}),t.jsx("p",{className:"text-white/50",children:"No transactions yet"})]})})}),t.jsx(x,{title:"Payout Settings",icon:"CreditCard",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Bank Account"}),t.jsx("input",{type:"text",placeholder:"Enter bank account details",className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Payout Frequency"}),t.jsxs("select",{className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"weekly",children:"Weekly"}),t.jsx("option",{value:"monthly",children:"Monthly"}),t.jsx("option",{value:"on-demand",children:"On Demand"})]})]}),t.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Update Settings"})]})})]}),"communication"===i&&t.jsx(L,{}),"analytics"===i&&t.jsx(w,{}),"fleet"===i&&t.jsx(M,{hostId:s?.id||"0"}),"pricing"===i&&t.jsx(_,{vehicleId:"",basePrice:0,onPriceUpdate:()=>{}}),"approvals"===i&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(f,{userRole:"host"}),t.jsx(x,{title:"Vehicle Listing Approval",icon:"Car",children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-white/70 text-sm",children:"Submit your vehicle listing for admin approval to make it available for renters."}),t.jsxs("button",{onClick:()=>ee("VehicleListing"),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center space-x-2",children:[t.jsx(h,{name:"Car",size:"sm"}),t.jsx("span",{children:"Request Vehicle Listing Approval"})]})]})}),t.jsx(x,{title:"Insurance Verification",icon:"Shield",children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-white/70 text-sm",children:"Submit your insurance documents for verification to ensure compliance with platform requirements."}),t.jsxs("button",{onClick:()=>ee("InsuranceVerification"),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors flex items-center space-x-2",children:[t.jsx(h,{name:"Shield",size:"sm"}),t.jsx("span",{children:"Request Insurance Verification"})]})]})})]})]}),U&&J&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsx("div",{className:"w-full max-w-md",children:t.jsx(V,{requestType:J,entityId:parseInt(Z?.toString()||s?.id||"0"),submittedBy:"host",onSuccess:()=>{F(!1),W(null),G(null)},onCancel:()=>{F(!1),W(null),G(null)}})})})]})};export{D,J as H,F as R};
