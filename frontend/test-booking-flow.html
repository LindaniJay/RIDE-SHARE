<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Booking Flow</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .success { color: green; }
        .error { color: red; }
        button { padding: 10px 15px; margin: 5px; }
    </style>
</head>
<body>
    <h1>Booking Flow Test</h1>
    
    <div class="test-section">
        <h2>1. Create Test Booking</h2>
        <button onclick="createTestBooking()">Create Test Booking</button>
        <div id="create-result"></div>
    </div>
    
    <div class="test-section">
        <h2>2. Check Stored Bookings</h2>
        <button onclick="checkStoredBookings()">Check Stored Bookings</button>
        <div id="stored-result"></div>
    </div>
    
    <div class="test-section">
        <h2>3. Simulate Renter Dashboard</h2>
        <button onclick="simulateRenterDashboard()">Simulate Renter Dashboard</button>
        <div id="renter-result"></div>
    </div>

    <script>
        // Simulate user ID (this would come from auth context in real app)
        const testUserId = 'test_user_123';
        
        function createTestBooking() {
            const mockBooking = {
                id: `booking_${Date.now()}`,
                vehicleId: 'vehicle_123',
                renterId: testUserId,
                hostId: 'host_456',
                startDate: '2024-12-15',
                endDate: '2024-12-17',
                totalDays: 2,
                pricePerDay: 450,
                totalPrice: 900,
                status: 'pending',
                paymentStatus: 'pending',
                vehicleTitle: 'Test Vehicle',
                vehicleImage: '/images/test.jpg',
                vehicleMake: 'Toyota',
                vehicleModel: 'Corolla',
                hostName: 'Test Host',
                renterName: 'Test User',
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            // Store in localStorage using the same key as bookingService
            const existingBookings = JSON.parse(localStorage.getItem('rideshare_bookings') || '[]');
            existingBookings.push(mockBooking);
            localStorage.setItem('rideshare_bookings', JSON.stringify(existingBookings));
            
            document.getElementById('create-result').innerHTML = 
                '<div class="success">✅ Test booking created successfully!</div>';
        }
        
        function checkStoredBookings() {
            const storedBookings = JSON.parse(localStorage.getItem('rideshare_bookings') || '[]');
            document.getElementById('stored-result').innerHTML = 
                `<div>Found ${storedBookings.length} bookings in localStorage:</div>
                 <pre>${JSON.stringify(storedBookings, null, 2)}</pre>`;
        }
        
        function simulateRenterDashboard() {
            const allBookings = JSON.parse(localStorage.getItem('rideshare_bookings') || '[]');
            const userBookings = allBookings.filter(booking => booking.renterId === testUserId);
            
            if (userBookings.length > 0) {
                document.getElementById('renter-result').innerHTML = 
                    `<div class="success">✅ Renter dashboard would show ${userBookings.length} bookings:</div>
                     <pre>${JSON.stringify(userBookings, null, 2)}</pre>`;
            } else {
                document.getElementById('renter-result').innerHTML = 
                    '<div class="error">❌ No bookings found for this user!</div>';
            }
        }
        
        // Clear localStorage button
        function clearStorage() {
            localStorage.removeItem('rideshare_bookings');
            document.getElementById('create-result').innerHTML = '';
            document.getElementById('stored-result').innerHTML = '';
            document.getElementById('renter-result').innerHTML = '';
        }
        
        // Add clear button
        document.body.innerHTML += '<div class="test-section"><button onclick="clearStorage()">Clear Storage</button></div>';
    </script>
</body>
</html>
